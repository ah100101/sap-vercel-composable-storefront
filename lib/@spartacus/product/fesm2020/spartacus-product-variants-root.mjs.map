{"version":3,"file":"spartacus-product-variants-root.mjs","sources":["../../../feature-libs/product/variants/root/feature-name.ts","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.component.ts","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.component.html","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.module.ts","../../../feature-libs/product/variants/root/product-variants-root.module.ts","../../../feature-libs/product/variants/root/public_api.ts","../../../feature-libs/product/variants/root/spartacus-product-variants-root.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const PRODUCT_VARIANTS_FEATURE = 'productVariants';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n} from '@angular/core';\nimport {\n  OccConfig,\n  Product,\n  VariantOption,\n  VariantOptionQualifier,\n  VariantQualifier,\n} from '@spartacus/core';\nimport {\n  ProductListItemContext,\n  ProductListOutlets,\n} from '@spartacus/storefront';\nimport { EMPTY, Observable, Subscription } from 'rxjs';\n\n@Component({\n  selector: 'cx-variant-style-icons',\n  templateUrl: './product-variant-style-icons.component.html',\n  styleUrls: ['./product-variant-style-icons.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductVariantStyleIconsComponent implements OnInit, OnDestroy {\n  constructor(\n    private config: OccConfig,\n    @Optional()\n    protected productListItemContext?: ProductListItemContext\n  ) {}\n\n  protected subscriptions = new Subscription();\n  readonly ProductListOutlets = ProductListOutlets;\n  readonly product$: Observable<Product> =\n    this.productListItemContext?.product$ ?? EMPTY;\n\n  @Input()\n  variants: VariantOption[];\n\n  variantNames: { [key: string]: string } = {};\n\n  ngOnInit() {\n    this.setVariantsNames();\n\n    this.subscriptions.add(\n      this.product$.subscribe((product: Product) => {\n        if (product.variantOptions && product.variantOptions.length) {\n          this.variants = product.variantOptions;\n          this.setVariantsNames();\n        }\n      })\n    );\n  }\n\n  private setVariantsNames() {\n    this.variants?.forEach((variant) => {\n      if (variant.code && variant.variantOptionQualifiers) {\n        this.variantNames[variant.code] =\n          this.getVariantName(variant.variantOptionQualifiers) || '';\n      }\n    });\n  }\n\n  getVariantThumbnailUrl(\n    variantOptionQualifiers: VariantOptionQualifier[]\n  ): string {\n    const thumbnail = variantOptionQualifiers.find(\n      (item) => item.qualifier === VariantQualifier.THUMBNAIL\n    );\n    return thumbnail\n      ? `${this.config?.backend?.occ?.baseUrl}${thumbnail.image?.url}`\n      : '';\n  }\n\n  private getVariantName(\n    variantOptionQualifiers: VariantOptionQualifier[]\n  ): string | undefined {\n    const rollupProperty = variantOptionQualifiers.find(\n      (item) => item.qualifier === VariantQualifier.ROLLUP_PROPERTY\n    );\n    const property = rollupProperty\n      ? variantOptionQualifiers.find(\n          (item) => item.qualifier === rollupProperty.value\n        )\n      : null;\n    return property ? property.value : '';\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n}\n","<ul class=\"variant-list\" *ngIf=\"variants && variants.length\">\n  <li *ngFor=\"let v of variants\">\n    <img\n      [attr.src]=\"getVariantThumbnailUrl(v.variantOptionQualifiers)\"\n      [attr.title]=\"variantNames[v.code]\"\n      [attr.alt]=\"variantNames[v.code]\"\n    />\n  </li>\n</ul>\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { UrlModule, I18nModule } from '@spartacus/core';\nimport { ProductVariantStyleIconsComponent } from './product-variant-style-icons.component';\nimport { RouterModule } from '@angular/router';\n\n@NgModule({\n  imports: [CommonModule, RouterModule, UrlModule, I18nModule],\n  declarations: [ProductVariantStyleIconsComponent],\n  exports: [ProductVariantStyleIconsComponent],\n})\nexport class ProductVariantStyleIconsModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NgModule } from '@angular/core';\nimport { CmsConfig, provideDefaultConfigFactory } from '@spartacus/core';\nimport { PRODUCT_VARIANTS_FEATURE } from './feature-name';\nimport {\n  ProductListOutlets,\n  OutletPosition,\n  provideOutlet,\n} from '@spartacus/storefront';\nimport { ProductVariantStyleIconsComponent } from './components/variant-style-icons/product-variant-style-icons.component';\nimport { ProductVariantStyleIconsModule } from './components/variant-style-icons/product-variant-style-icons.module';\n\n// TODO: Inline this factory when we start releasing Ivy compiled libraries\nexport function defaultProductVariantsComponentsConfig(): CmsConfig {\n  const config: CmsConfig = {\n    featureModules: {\n      [PRODUCT_VARIANTS_FEATURE]: {\n        cmsComponents: ['ProductVariantSelectorComponent'],\n      },\n    },\n  };\n\n  return config;\n}\n\n@NgModule({\n  imports: [ProductVariantStyleIconsModule],\n  providers: [\n    provideDefaultConfigFactory(defaultProductVariantsComponentsConfig),\n    provideOutlet({\n      id: ProductListOutlets.ITEM_DETAILS,\n      position: OutletPosition.AFTER,\n      component: ProductVariantStyleIconsComponent,\n    }),\n  ],\n})\nexport class ProductVariantsRootModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './feature-name';\nexport * from './product-variants-root.module';\n\nexport * from './components/variant-style-icons/product-variant-style-icons.module';\nexport * from './components/variant-style-icons/product-variant-style-icons.component';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}