/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component } from '@angular/core';
import { isNotUndefined, } from '@spartacus/core';
import { combineLatest } from 'rxjs';
import { filter, map, take, tap } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/core";
import * as i2 from "@spartacus/order/root";
import * as i3 from "@angular/common";
import * as i4 from "@angular/router";
import * as i5 from "@spartacus/storefront";
export class OrderHistoryComponent {
    constructor(routing, orderHistoryFacade, translation, replenishmentOrderHistoryFacade) {
        this.routing = routing;
        this.orderHistoryFacade = orderHistoryFacade;
        this.translation = translation;
        this.replenishmentOrderHistoryFacade = replenishmentOrderHistoryFacade;
        this.PAGE_SIZE = 5;
        this.orders$ = this.orderHistoryFacade
            .getOrderHistoryList(this.PAGE_SIZE)
            .pipe(tap((orders) => {
            if (orders?.pagination?.sort) {
                this.sortType = orders.pagination.sort;
            }
            this.hasPONumber =
                orders?.orders?.[0]?.purchaseOrderNumber !== undefined;
        }));
        this.hasReplenishmentOrder$ = this.replenishmentOrderHistoryFacade
            .getReplenishmentOrderDetails()
            .pipe(map((order) => order && Object.keys(order).length !== 0));
        this.isLoaded$ = this.orderHistoryFacade.getOrderHistoryListLoaded();
        /**
         * When "Order Return" feature is enabled, this component becomes one tab in
         * TabParagraphContainerComponent. This can be read from TabParagraphContainer.
         */
        this.tabTitleParam$ = this.orders$.pipe(map((order) => order?.pagination?.totalResults), filter(isNotUndefined), take(1));
    }
    ngOnDestroy() {
        this.orderHistoryFacade.clearOrderList();
    }
    changeSortCode(sortCode) {
        const event = {
            sortCode,
            currentPage: 0,
        };
        this.sortType = sortCode;
        this.fetchOrders(event);
    }
    pageChange(page) {
        const event = {
            sortCode: this.sortType,
            currentPage: page,
        };
        this.fetchOrders(event);
    }
    goToOrderDetail(order) {
        this.routing.go({
            cxRoute: 'orderDetails',
            params: order,
        });
    }
    getSortLabels() {
        return combineLatest([
            this.translation.translate('sorting.date'),
            this.translation.translate('sorting.orderNumber'),
        ]).pipe(map(([textByDate, textByOrderNumber]) => {
            return {
                byDate: textByDate,
                byOrderNumber: textByOrderNumber,
            };
        }));
    }
    fetchOrders(event) {
        this.orderHistoryFacade.loadOrderList(this.PAGE_SIZE, event.currentPage, event.sortCode);
    }
}
OrderHistoryComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: OrderHistoryComponent, deps: [{ token: i1.RoutingService }, { token: i2.OrderHistoryFacade }, { token: i1.TranslationService }, { token: i2.ReplenishmentOrderHistoryFacade }], target: i0.ɵɵFactoryTarget.Component });
OrderHistoryComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: OrderHistoryComponent, selector: "cx-order-history", ngImport: i0, template: "<ng-container\n  *ngIf=\"{\n    orderHistory: orders$ | async,\n    replenishmentOrder: hasReplenishmentOrder$ | async\n  } as type\"\n>\n  <ng-container *ngIf=\"type.orderHistory\">\n    <div>\n      <!-- HEADER -->\n      <div\n        [ngClass]=\"\n          type.replenishmentOrder\n            ? 'cx-replenishment-details-order-history-header'\n            : 'cx-order-history-header'\n        \"\n      >\n        <h4 *ngIf=\"type.replenishmentOrder\">\n          {{ 'orderHistory.replenishmentHistory' | cxTranslate }}\n        </h4>\n        <h2 *ngIf=\"!type.replenishmentOrder\">\n          {{ 'orderHistory.orderHistory' | cxTranslate }}\n        </h2>\n      </div>\n\n      <!-- BODY -->\n      <div class=\"cx-order-history-body\">\n        <ng-container\n          *ngIf=\"type.orderHistory.pagination.totalResults > 0; else noOrder\"\n        >\n          <!-- Select Form and Pagination Top -->\n          <div class=\"cx-order-history-sort top\">\n            <label class=\"cx-order-history-form-group form-group\"\n              ><span>\n                {{ 'orderHistory.sortBy' | cxTranslate }}\n              </span>\n              <cx-sorting\n                [sortOptions]=\"type.orderHistory.sorts\"\n                [sortLabels]=\"getSortLabels() | async\"\n                (sortListEvent)=\"changeSortCode($event)\"\n                [selectedOption]=\"type.orderHistory.pagination.sort\"\n                placeholder=\"{{ 'orderHistory.sortBy' | cxTranslate }}\"\n                [ariaLabel]=\"'orderHistory.sortOrders' | cxTranslate\"\n                ariaControls=\"order-history-table\"\n              ></cx-sorting>\n            </label>\n            <div\n              *ngIf=\"type.orderHistory.pagination.totalPages > 1\"\n              class=\"cx-order-history-pagination\"\n            >\n              <cx-pagination\n                [pagination]=\"type.orderHistory.pagination\"\n                (viewPageEvent)=\"pageChange($event)\"\n              ></cx-pagination>\n            </div>\n          </div>\n\n          <table\n            role=\"table\"\n            id=\"order-history-table\"\n            class=\"table cx-order-history-table\"\n            [ngClass]=\"{ 'cx-order-history-table-po': hasPONumber }\"\n          >\n            <caption class=\"cx-visually-hidden\">\n              {{\n                'orderHistory.orderHistory' | cxTranslate\n              }}\n            </caption>\n            <thead class=\"cx-order-history-thead-mobile\">\n              <tr role=\"row\">\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.orderId' | cxTranslate }}\n                </th>\n                <ng-container *ngIf=\"hasPONumber\">\n                  <th role=\"columnheader\">\n                    {{ 'orderHistory.PONumber' | cxTranslate }}\n                  </th>\n                  <th role=\"columnheader\">\n                    {{ 'orderHistory.costCenter' | cxTranslate }}\n                  </th>\n                </ng-container>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.date' | cxTranslate }}\n                </th>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.status' | cxTranslate }}\n                </th>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.total' | cxTranslate }}\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr\n                role=\"row\"\n                *ngFor=\"let order of type.orderHistory.orders\"\n                (click)=\"goToOrderDetail(order)\"\n              >\n                <td role=\"cell\" class=\"cx-order-history-code\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.orderId' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{ order?.code }}</a\n                  >\n                </td>\n                <ng-container *ngIf=\"hasPONumber\">\n                  <td role=\"cell\" class=\"cx-order-history-po\">\n                    <div class=\"cx-order-history-label\">\n                      {{ 'orderHistory.PONumber' | cxTranslate }}\n                    </div>\n                    <a\n                      *ngIf=\"order.purchaseOrderNumber\"\n                      [routerLink]=\"\n                        {\n                          cxRoute: 'orderDetails',\n                          params: order\n                        } | cxUrl\n                      \"\n                      class=\"cx-order-history-value\"\n                    >\n                      {{ order.purchaseOrderNumber }}</a\n                    >\n                  </td>\n                  <td role=\"cell\" class=\"cx-order-history-cost-center\">\n                    <div class=\"cx-order-history-label\">\n                      {{ 'orderHistory.costCenter' | cxTranslate }}\n                    </div>\n                    <a\n                      *ngIf=\"order.costCenter?.name\"\n                      [routerLink]=\"\n                        {\n                          cxRoute: 'orderDetails',\n                          params: order\n                        } | cxUrl\n                      \"\n                      class=\"cx-order-history-value\"\n                    >\n                      {{ order.costCenter?.name }}</a\n                    >\n                  </td>\n                </ng-container>\n\n                <td role=\"cell\" class=\"cx-order-history-placed\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.date' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                    >{{ order?.placed | cxDate: 'longDate' }}</a\n                  >\n                </td>\n                <td role=\"cell\" class=\"cx-order-history-status\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.status' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{\n                      'orderDetails.statusDisplay_' + order?.statusDisplay\n                        | cxTranslate\n                    }}</a\n                  >\n                </td>\n                <td role=\"cell\" class=\"cx-order-history-total\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.total' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{ order?.total.formattedValue }}</a\n                  >\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n          <!-- Select Form and Pagination Bottom -->\n          <div class=\"cx-order-history-sort bottom\">\n            <div\n              *ngIf=\"type.orderHistory.pagination.totalPages > 1\"\n              class=\"cx-order-history-pagination\"\n            >\n              <cx-pagination\n                [pagination]=\"type.orderHistory.pagination\"\n                (viewPageEvent)=\"pageChange($event)\"\n              ></cx-pagination>\n            </div>\n          </div>\n        </ng-container>\n\n        <!-- NO ORDER CONTAINER -->\n        <ng-template #noOrder>\n          <div\n            *ngIf=\"isLoaded$ | async\"\n            [ngClass]=\"\n              type.replenishmentOrder\n                ? 'cx-replenishment-details-order-history-no-order'\n                : 'cx-order-history-no-order'\n            \"\n          >\n            <div>\n              <ng-container *ngIf=\"type.replenishmentOrder; else otherOrder\">\n                <div>{{ 'orderHistory.notFound' | cxTranslate }}</div>\n              </ng-container>\n\n              <ng-template #otherOrder>\n                <div>{{ 'orderHistory.noOrders' | cxTranslate }}</div>\n                <a\n                  [routerLink]=\"{ cxRoute: 'home' } | cxUrl\"\n                  routerLinkActive=\"active\"\n                  class=\"btn btn-primary btn-block\"\n                  >{{ 'orderHistory.startShopping' | cxTranslate }}</a\n                >\n              </ng-template>\n            </div>\n          </div>\n        </ng-template>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i4.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "component", type: i5.SortingComponent, selector: "cx-sorting", inputs: ["sortOptions", "ariaControls", "ariaLabel", "selectedOption", "placeholder", "sortLabels"], outputs: ["sortListEvent"] }, { kind: "component", type: i5.PaginationComponent, selector: "cx-pagination", inputs: ["pageRoute", "queryParam", "defaultPage", "pagination"], outputs: ["viewPageEvent"] }, { kind: "pipe", type: i3.AsyncPipe, name: "async" }, { kind: "pipe", type: i1.UrlPipe, name: "cxUrl" }, { kind: "pipe", type: i1.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i1.CxDatePipe, name: "cxDate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: OrderHistoryComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-order-history', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-container\n  *ngIf=\"{\n    orderHistory: orders$ | async,\n    replenishmentOrder: hasReplenishmentOrder$ | async\n  } as type\"\n>\n  <ng-container *ngIf=\"type.orderHistory\">\n    <div>\n      <!-- HEADER -->\n      <div\n        [ngClass]=\"\n          type.replenishmentOrder\n            ? 'cx-replenishment-details-order-history-header'\n            : 'cx-order-history-header'\n        \"\n      >\n        <h4 *ngIf=\"type.replenishmentOrder\">\n          {{ 'orderHistory.replenishmentHistory' | cxTranslate }}\n        </h4>\n        <h2 *ngIf=\"!type.replenishmentOrder\">\n          {{ 'orderHistory.orderHistory' | cxTranslate }}\n        </h2>\n      </div>\n\n      <!-- BODY -->\n      <div class=\"cx-order-history-body\">\n        <ng-container\n          *ngIf=\"type.orderHistory.pagination.totalResults > 0; else noOrder\"\n        >\n          <!-- Select Form and Pagination Top -->\n          <div class=\"cx-order-history-sort top\">\n            <label class=\"cx-order-history-form-group form-group\"\n              ><span>\n                {{ 'orderHistory.sortBy' | cxTranslate }}\n              </span>\n              <cx-sorting\n                [sortOptions]=\"type.orderHistory.sorts\"\n                [sortLabels]=\"getSortLabels() | async\"\n                (sortListEvent)=\"changeSortCode($event)\"\n                [selectedOption]=\"type.orderHistory.pagination.sort\"\n                placeholder=\"{{ 'orderHistory.sortBy' | cxTranslate }}\"\n                [ariaLabel]=\"'orderHistory.sortOrders' | cxTranslate\"\n                ariaControls=\"order-history-table\"\n              ></cx-sorting>\n            </label>\n            <div\n              *ngIf=\"type.orderHistory.pagination.totalPages > 1\"\n              class=\"cx-order-history-pagination\"\n            >\n              <cx-pagination\n                [pagination]=\"type.orderHistory.pagination\"\n                (viewPageEvent)=\"pageChange($event)\"\n              ></cx-pagination>\n            </div>\n          </div>\n\n          <table\n            role=\"table\"\n            id=\"order-history-table\"\n            class=\"table cx-order-history-table\"\n            [ngClass]=\"{ 'cx-order-history-table-po': hasPONumber }\"\n          >\n            <caption class=\"cx-visually-hidden\">\n              {{\n                'orderHistory.orderHistory' | cxTranslate\n              }}\n            </caption>\n            <thead class=\"cx-order-history-thead-mobile\">\n              <tr role=\"row\">\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.orderId' | cxTranslate }}\n                </th>\n                <ng-container *ngIf=\"hasPONumber\">\n                  <th role=\"columnheader\">\n                    {{ 'orderHistory.PONumber' | cxTranslate }}\n                  </th>\n                  <th role=\"columnheader\">\n                    {{ 'orderHistory.costCenter' | cxTranslate }}\n                  </th>\n                </ng-container>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.date' | cxTranslate }}\n                </th>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.status' | cxTranslate }}\n                </th>\n                <th role=\"columnheader\">\n                  {{ 'orderHistory.total' | cxTranslate }}\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr\n                role=\"row\"\n                *ngFor=\"let order of type.orderHistory.orders\"\n                (click)=\"goToOrderDetail(order)\"\n              >\n                <td role=\"cell\" class=\"cx-order-history-code\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.orderId' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{ order?.code }}</a\n                  >\n                </td>\n                <ng-container *ngIf=\"hasPONumber\">\n                  <td role=\"cell\" class=\"cx-order-history-po\">\n                    <div class=\"cx-order-history-label\">\n                      {{ 'orderHistory.PONumber' | cxTranslate }}\n                    </div>\n                    <a\n                      *ngIf=\"order.purchaseOrderNumber\"\n                      [routerLink]=\"\n                        {\n                          cxRoute: 'orderDetails',\n                          params: order\n                        } | cxUrl\n                      \"\n                      class=\"cx-order-history-value\"\n                    >\n                      {{ order.purchaseOrderNumber }}</a\n                    >\n                  </td>\n                  <td role=\"cell\" class=\"cx-order-history-cost-center\">\n                    <div class=\"cx-order-history-label\">\n                      {{ 'orderHistory.costCenter' | cxTranslate }}\n                    </div>\n                    <a\n                      *ngIf=\"order.costCenter?.name\"\n                      [routerLink]=\"\n                        {\n                          cxRoute: 'orderDetails',\n                          params: order\n                        } | cxUrl\n                      \"\n                      class=\"cx-order-history-value\"\n                    >\n                      {{ order.costCenter?.name }}</a\n                    >\n                  </td>\n                </ng-container>\n\n                <td role=\"cell\" class=\"cx-order-history-placed\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.date' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                    >{{ order?.placed | cxDate: 'longDate' }}</a\n                  >\n                </td>\n                <td role=\"cell\" class=\"cx-order-history-status\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.status' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{\n                      'orderDetails.statusDisplay_' + order?.statusDisplay\n                        | cxTranslate\n                    }}</a\n                  >\n                </td>\n                <td role=\"cell\" class=\"cx-order-history-total\">\n                  <div class=\"cx-order-history-label\">\n                    {{ 'orderHistory.total' | cxTranslate }}\n                  </div>\n                  <a\n                    [routerLink]=\"\n                      {\n                        cxRoute: 'orderDetails',\n                        params: order\n                      } | cxUrl\n                    \"\n                    class=\"cx-order-history-value\"\n                  >\n                    {{ order?.total.formattedValue }}</a\n                  >\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n          <!-- Select Form and Pagination Bottom -->\n          <div class=\"cx-order-history-sort bottom\">\n            <div\n              *ngIf=\"type.orderHistory.pagination.totalPages > 1\"\n              class=\"cx-order-history-pagination\"\n            >\n              <cx-pagination\n                [pagination]=\"type.orderHistory.pagination\"\n                (viewPageEvent)=\"pageChange($event)\"\n              ></cx-pagination>\n            </div>\n          </div>\n        </ng-container>\n\n        <!-- NO ORDER CONTAINER -->\n        <ng-template #noOrder>\n          <div\n            *ngIf=\"isLoaded$ | async\"\n            [ngClass]=\"\n              type.replenishmentOrder\n                ? 'cx-replenishment-details-order-history-no-order'\n                : 'cx-order-history-no-order'\n            \"\n          >\n            <div>\n              <ng-container *ngIf=\"type.replenishmentOrder; else otherOrder\">\n                <div>{{ 'orderHistory.notFound' | cxTranslate }}</div>\n              </ng-container>\n\n              <ng-template #otherOrder>\n                <div>{{ 'orderHistory.noOrders' | cxTranslate }}</div>\n                <a\n                  [routerLink]=\"{ cxRoute: 'home' } | cxUrl\"\n                  routerLinkActive=\"active\"\n                  class=\"btn btn-primary btn-block\"\n                  >{{ 'orderHistory.startShopping' | cxTranslate }}</a\n                >\n              </ng-template>\n            </div>\n          </div>\n        </ng-template>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.RoutingService }, { type: i2.OrderHistoryFacade }, { type: i1.TranslationService }, { type: i2.ReplenishmentOrderHistoryFacade }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JkZXItaGlzdG9yeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvb3JkZXIvY29tcG9uZW50cy9vcmRlci1oaXN0b3J5L29yZGVyLWhpc3RvcnkuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL29yZGVyL2NvbXBvbmVudHMvb3JkZXItaGlzdG9yeS9vcmRlci1oaXN0b3J5LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0dBSUc7QUFFSCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBQzlFLE9BQU8sRUFDTCxjQUFjLEdBR2YsTUFBTSxpQkFBaUIsQ0FBQztBQU96QixPQUFPLEVBQUUsYUFBYSxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQ2pELE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7OztBQU94RCxNQUFNLE9BQU8scUJBQXFCO0lBQ2hDLFlBQ1ksT0FBdUIsRUFDdkIsa0JBQXNDLEVBQ3RDLFdBQStCLEVBQy9CLCtCQUFnRTtRQUhoRSxZQUFPLEdBQVAsT0FBTyxDQUFnQjtRQUN2Qix1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBQ3RDLGdCQUFXLEdBQVgsV0FBVyxDQUFvQjtRQUMvQixvQ0FBK0IsR0FBL0IsK0JBQStCLENBQWlDO1FBR3BFLGNBQVMsR0FBRyxDQUFDLENBQUM7UUFJdEIsWUFBTyxHQUE2QyxJQUFJLENBQUMsa0JBQWtCO2FBQ3hFLG1CQUFtQixDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7YUFDbkMsSUFBSSxDQUNILEdBQUcsQ0FBQyxDQUFDLE1BQW9DLEVBQUUsRUFBRTtZQUMzQyxJQUFJLE1BQU0sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFO2dCQUM1QixJQUFJLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO2FBQ3hDO1lBQ0QsSUFBSSxDQUFDLFdBQVc7Z0JBQ2QsTUFBTSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLG1CQUFtQixLQUFLLFNBQVMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FDSCxDQUFDO1FBRUosMkJBQXNCLEdBQ3BCLElBQUksQ0FBQywrQkFBK0I7YUFDakMsNEJBQTRCLEVBQUU7YUFDOUIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFcEUsY0FBUyxHQUNQLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyx5QkFBeUIsRUFBRSxDQUFDO1FBRXREOzs7V0FHRztRQUNILG1CQUFjLEdBQXVCLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUNwRCxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsWUFBWSxDQUFDLEVBQy9DLE1BQU0sQ0FBQyxjQUFjLENBQUMsRUFDdEIsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUNSLENBQUM7SUFsQ0MsQ0FBQztJQW9DSixXQUFXO1FBQ1QsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQzNDLENBQUM7SUFFRCxjQUFjLENBQUMsUUFBZ0I7UUFDN0IsTUFBTSxLQUFLLEdBQThDO1lBQ3ZELFFBQVE7WUFDUixXQUFXLEVBQUUsQ0FBQztTQUNmLENBQUM7UUFDRixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFFRCxVQUFVLENBQUMsSUFBWTtRQUNyQixNQUFNLEtBQUssR0FBOEM7WUFDdkQsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRO1lBQ3ZCLFdBQVcsRUFBRSxJQUFJO1NBQ2xCLENBQUM7UUFDRixJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFFRCxlQUFlLENBQUMsS0FBWTtRQUMxQixJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztZQUNkLE9BQU8sRUFBRSxjQUFjO1lBQ3ZCLE1BQU0sRUFBRSxLQUFLO1NBQ2QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELGFBQWE7UUFDWCxPQUFPLGFBQWEsQ0FBQztZQUNuQixJQUFJLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUM7WUFDMUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMscUJBQXFCLENBQUM7U0FDbEQsQ0FBQyxDQUFDLElBQUksQ0FDTCxHQUFHLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxpQkFBaUIsQ0FBQyxFQUFFLEVBQUU7WUFDdEMsT0FBTztnQkFDTCxNQUFNLEVBQUUsVUFBVTtnQkFDbEIsYUFBYSxFQUFFLGlCQUFpQjthQUNqQyxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUM7SUFFTyxXQUFXLENBQUMsS0FBZ0Q7UUFDbEUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FDbkMsSUFBSSxDQUFDLFNBQVMsRUFDZCxLQUFLLENBQUMsV0FBVyxFQUNqQixLQUFLLENBQUMsUUFBUSxDQUNmLENBQUM7SUFDSixDQUFDOztrSEExRlUscUJBQXFCO3NHQUFyQixxQkFBcUIsd0RDMUJsQyw0clNBeVBBOzJGRC9OYSxxQkFBcUI7a0JBTGpDLFNBQVM7K0JBQ0Usa0JBQWtCLG1CQUVYLHVCQUF1QixDQUFDLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogU1BEWC1GaWxlQ29weXJpZ2h0VGV4dDogMjAyMyBTQVAgU3BhcnRhY3VzIHRlYW0gPHNwYXJ0YWN1cy10ZWFtQHNhcC5jb20+XG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ29tcG9uZW50LCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIGlzTm90VW5kZWZpbmVkLFxuICBSb3V0aW5nU2VydmljZSxcbiAgVHJhbnNsYXRpb25TZXJ2aWNlLFxufSBmcm9tICdAc3BhcnRhY3VzL2NvcmUnO1xuaW1wb3J0IHtcbiAgT3JkZXIsXG4gIE9yZGVySGlzdG9yeUZhY2FkZSxcbiAgT3JkZXJIaXN0b3J5TGlzdCxcbiAgUmVwbGVuaXNobWVudE9yZGVySGlzdG9yeUZhY2FkZSxcbn0gZnJvbSAnQHNwYXJ0YWN1cy9vcmRlci9yb290JztcbmltcG9ydCB7IGNvbWJpbmVMYXRlc3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGZpbHRlciwgbWFwLCB0YWtlLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2N4LW9yZGVyLWhpc3RvcnknLFxuICB0ZW1wbGF0ZVVybDogJy4vb3JkZXItaGlzdG9yeS5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBPcmRlckhpc3RvcnlDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3kge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgcm91dGluZzogUm91dGluZ1NlcnZpY2UsXG4gICAgcHJvdGVjdGVkIG9yZGVySGlzdG9yeUZhY2FkZTogT3JkZXJIaXN0b3J5RmFjYWRlLFxuICAgIHByb3RlY3RlZCB0cmFuc2xhdGlvbjogVHJhbnNsYXRpb25TZXJ2aWNlLFxuICAgIHByb3RlY3RlZCByZXBsZW5pc2htZW50T3JkZXJIaXN0b3J5RmFjYWRlOiBSZXBsZW5pc2htZW50T3JkZXJIaXN0b3J5RmFjYWRlXG4gICkge31cblxuICBwcml2YXRlIFBBR0VfU0laRSA9IDU7XG4gIHNvcnRUeXBlOiBzdHJpbmc7XG4gIGhhc1BPTnVtYmVyOiBib29sZWFuIHwgdW5kZWZpbmVkO1xuXG4gIG9yZGVycyQ6IE9ic2VydmFibGU8T3JkZXJIaXN0b3J5TGlzdCB8IHVuZGVmaW5lZD4gPSB0aGlzLm9yZGVySGlzdG9yeUZhY2FkZVxuICAgIC5nZXRPcmRlckhpc3RvcnlMaXN0KHRoaXMuUEFHRV9TSVpFKVxuICAgIC5waXBlKFxuICAgICAgdGFwKChvcmRlcnM6IE9yZGVySGlzdG9yeUxpc3QgfCB1bmRlZmluZWQpID0+IHtcbiAgICAgICAgaWYgKG9yZGVycz8ucGFnaW5hdGlvbj8uc29ydCkge1xuICAgICAgICAgIHRoaXMuc29ydFR5cGUgPSBvcmRlcnMucGFnaW5hdGlvbi5zb3J0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFzUE9OdW1iZXIgPVxuICAgICAgICAgIG9yZGVycz8ub3JkZXJzPy5bMF0/LnB1cmNoYXNlT3JkZXJOdW1iZXIgIT09IHVuZGVmaW5lZDtcbiAgICAgIH0pXG4gICAgKTtcblxuICBoYXNSZXBsZW5pc2htZW50T3JkZXIkOiBPYnNlcnZhYmxlPGJvb2xlYW4+ID1cbiAgICB0aGlzLnJlcGxlbmlzaG1lbnRPcmRlckhpc3RvcnlGYWNhZGVcbiAgICAgIC5nZXRSZXBsZW5pc2htZW50T3JkZXJEZXRhaWxzKClcbiAgICAgIC5waXBlKG1hcCgob3JkZXIpID0+IG9yZGVyICYmIE9iamVjdC5rZXlzKG9yZGVyKS5sZW5ndGggIT09IDApKTtcblxuICBpc0xvYWRlZCQ6IE9ic2VydmFibGU8Ym9vbGVhbj4gPVxuICAgIHRoaXMub3JkZXJIaXN0b3J5RmFjYWRlLmdldE9yZGVySGlzdG9yeUxpc3RMb2FkZWQoKTtcblxuICAvKipcbiAgICogV2hlbiBcIk9yZGVyIFJldHVyblwiIGZlYXR1cmUgaXMgZW5hYmxlZCwgdGhpcyBjb21wb25lbnQgYmVjb21lcyBvbmUgdGFiIGluXG4gICAqIFRhYlBhcmFncmFwaENvbnRhaW5lckNvbXBvbmVudC4gVGhpcyBjYW4gYmUgcmVhZCBmcm9tIFRhYlBhcmFncmFwaENvbnRhaW5lci5cbiAgICovXG4gIHRhYlRpdGxlUGFyYW0kOiBPYnNlcnZhYmxlPG51bWJlcj4gPSB0aGlzLm9yZGVycyQucGlwZShcbiAgICBtYXAoKG9yZGVyKSA9PiBvcmRlcj8ucGFnaW5hdGlvbj8udG90YWxSZXN1bHRzKSxcbiAgICBmaWx0ZXIoaXNOb3RVbmRlZmluZWQpLFxuICAgIHRha2UoMSlcbiAgKTtcblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLm9yZGVySGlzdG9yeUZhY2FkZS5jbGVhck9yZGVyTGlzdCgpO1xuICB9XG5cbiAgY2hhbmdlU29ydENvZGUoc29ydENvZGU6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGV2ZW50OiB7IHNvcnRDb2RlOiBzdHJpbmc7IGN1cnJlbnRQYWdlOiBudW1iZXIgfSA9IHtcbiAgICAgIHNvcnRDb2RlLFxuICAgICAgY3VycmVudFBhZ2U6IDAsXG4gICAgfTtcbiAgICB0aGlzLnNvcnRUeXBlID0gc29ydENvZGU7XG4gICAgdGhpcy5mZXRjaE9yZGVycyhldmVudCk7XG4gIH1cblxuICBwYWdlQ2hhbmdlKHBhZ2U6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IGV2ZW50OiB7IHNvcnRDb2RlOiBzdHJpbmc7IGN1cnJlbnRQYWdlOiBudW1iZXIgfSA9IHtcbiAgICAgIHNvcnRDb2RlOiB0aGlzLnNvcnRUeXBlLFxuICAgICAgY3VycmVudFBhZ2U6IHBhZ2UsXG4gICAgfTtcbiAgICB0aGlzLmZldGNoT3JkZXJzKGV2ZW50KTtcbiAgfVxuXG4gIGdvVG9PcmRlckRldGFpbChvcmRlcjogT3JkZXIpOiB2b2lkIHtcbiAgICB0aGlzLnJvdXRpbmcuZ28oe1xuICAgICAgY3hSb3V0ZTogJ29yZGVyRGV0YWlscycsXG4gICAgICBwYXJhbXM6IG9yZGVyLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0U29ydExhYmVscygpOiBPYnNlcnZhYmxlPHsgYnlEYXRlOiBzdHJpbmc7IGJ5T3JkZXJOdW1iZXI6IHN0cmluZyB9PiB7XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QoW1xuICAgICAgdGhpcy50cmFuc2xhdGlvbi50cmFuc2xhdGUoJ3NvcnRpbmcuZGF0ZScpLFxuICAgICAgdGhpcy50cmFuc2xhdGlvbi50cmFuc2xhdGUoJ3NvcnRpbmcub3JkZXJOdW1iZXInKSxcbiAgICBdKS5waXBlKFxuICAgICAgbWFwKChbdGV4dEJ5RGF0ZSwgdGV4dEJ5T3JkZXJOdW1iZXJdKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYnlEYXRlOiB0ZXh0QnlEYXRlLFxuICAgICAgICAgIGJ5T3JkZXJOdW1iZXI6IHRleHRCeU9yZGVyTnVtYmVyLFxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBmZXRjaE9yZGVycyhldmVudDogeyBzb3J0Q29kZTogc3RyaW5nOyBjdXJyZW50UGFnZTogbnVtYmVyIH0pOiB2b2lkIHtcbiAgICB0aGlzLm9yZGVySGlzdG9yeUZhY2FkZS5sb2FkT3JkZXJMaXN0KFxuICAgICAgdGhpcy5QQUdFX1NJWkUsXG4gICAgICBldmVudC5jdXJyZW50UGFnZSxcbiAgICAgIGV2ZW50LnNvcnRDb2RlXG4gICAgKTtcbiAgfVxufVxuIiwiPG5nLWNvbnRhaW5lclxuICAqbmdJZj1cIntcbiAgICBvcmRlckhpc3Rvcnk6IG9yZGVycyQgfCBhc3luYyxcbiAgICByZXBsZW5pc2htZW50T3JkZXI6IGhhc1JlcGxlbmlzaG1lbnRPcmRlciQgfCBhc3luY1xuICB9IGFzIHR5cGVcIlxuPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwidHlwZS5vcmRlckhpc3RvcnlcIj5cbiAgICA8ZGl2PlxuICAgICAgPCEtLSBIRUFERVIgLS0+XG4gICAgICA8ZGl2XG4gICAgICAgIFtuZ0NsYXNzXT1cIlxuICAgICAgICAgIHR5cGUucmVwbGVuaXNobWVudE9yZGVyXG4gICAgICAgICAgICA/ICdjeC1yZXBsZW5pc2htZW50LWRldGFpbHMtb3JkZXItaGlzdG9yeS1oZWFkZXInXG4gICAgICAgICAgICA6ICdjeC1vcmRlci1oaXN0b3J5LWhlYWRlcidcbiAgICAgICAgXCJcbiAgICAgID5cbiAgICAgICAgPGg0ICpuZ0lmPVwidHlwZS5yZXBsZW5pc2htZW50T3JkZXJcIj5cbiAgICAgICAgICB7eyAnb3JkZXJIaXN0b3J5LnJlcGxlbmlzaG1lbnRIaXN0b3J5JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgIDwvaDQ+XG4gICAgICAgIDxoMiAqbmdJZj1cIiF0eXBlLnJlcGxlbmlzaG1lbnRPcmRlclwiPlxuICAgICAgICAgIHt7ICdvcmRlckhpc3Rvcnkub3JkZXJIaXN0b3J5JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgIDwvaDI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPCEtLSBCT0RZIC0tPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktYm9keVwiPlxuICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgKm5nSWY9XCJ0eXBlLm9yZGVySGlzdG9yeS5wYWdpbmF0aW9uLnRvdGFsUmVzdWx0cyA+IDA7IGVsc2Ugbm9PcmRlclwiXG4gICAgICAgID5cbiAgICAgICAgICA8IS0tIFNlbGVjdCBGb3JtIGFuZCBQYWdpbmF0aW9uIFRvcCAtLT5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1zb3J0IHRvcFwiPlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1mb3JtLWdyb3VwIGZvcm0tZ3JvdXBcIlxuICAgICAgICAgICAgICA+PHNwYW4+XG4gICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5zb3J0QnknIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICA8Y3gtc29ydGluZ1xuICAgICAgICAgICAgICAgIFtzb3J0T3B0aW9uc109XCJ0eXBlLm9yZGVySGlzdG9yeS5zb3J0c1wiXG4gICAgICAgICAgICAgICAgW3NvcnRMYWJlbHNdPVwiZ2V0U29ydExhYmVscygpIHwgYXN5bmNcIlxuICAgICAgICAgICAgICAgIChzb3J0TGlzdEV2ZW50KT1cImNoYW5nZVNvcnRDb2RlKCRldmVudClcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZE9wdGlvbl09XCJ0eXBlLm9yZGVySGlzdG9yeS5wYWdpbmF0aW9uLnNvcnRcIlxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3sgJ29yZGVySGlzdG9yeS5zb3J0QnknIHwgY3hUcmFuc2xhdGUgfX1cIlxuICAgICAgICAgICAgICAgIFthcmlhTGFiZWxdPVwiJ29yZGVySGlzdG9yeS5zb3J0T3JkZXJzJyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgICAgICAgICAgICBhcmlhQ29udHJvbHM9XCJvcmRlci1oaXN0b3J5LXRhYmxlXCJcbiAgICAgICAgICAgICAgPjwvY3gtc29ydGluZz5cbiAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICpuZ0lmPVwidHlwZS5vcmRlckhpc3RvcnkucGFnaW5hdGlvbi50b3RhbFBhZ2VzID4gMVwiXG4gICAgICAgICAgICAgIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1wYWdpbmF0aW9uXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPGN4LXBhZ2luYXRpb25cbiAgICAgICAgICAgICAgICBbcGFnaW5hdGlvbl09XCJ0eXBlLm9yZGVySGlzdG9yeS5wYWdpbmF0aW9uXCJcbiAgICAgICAgICAgICAgICAodmlld1BhZ2VFdmVudCk9XCJwYWdlQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgICA+PC9jeC1wYWdpbmF0aW9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8dGFibGVcbiAgICAgICAgICAgIHJvbGU9XCJ0YWJsZVwiXG4gICAgICAgICAgICBpZD1cIm9yZGVyLWhpc3RvcnktdGFibGVcIlxuICAgICAgICAgICAgY2xhc3M9XCJ0YWJsZSBjeC1vcmRlci1oaXN0b3J5LXRhYmxlXCJcbiAgICAgICAgICAgIFtuZ0NsYXNzXT1cInsgJ2N4LW9yZGVyLWhpc3RvcnktdGFibGUtcG8nOiBoYXNQT051bWJlciB9XCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8Y2FwdGlvbiBjbGFzcz1cImN4LXZpc3VhbGx5LWhpZGRlblwiPlxuICAgICAgICAgICAgICB7e1xuICAgICAgICAgICAgICAgICdvcmRlckhpc3Rvcnkub3JkZXJIaXN0b3J5JyB8IGN4VHJhbnNsYXRlXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA8L2NhcHRpb24+XG4gICAgICAgICAgICA8dGhlYWQgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXRoZWFkLW1vYmlsZVwiPlxuICAgICAgICAgICAgICA8dHIgcm9sZT1cInJvd1wiPlxuICAgICAgICAgICAgICAgIDx0aCByb2xlPVwiY29sdW1uaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICB7eyAnb3JkZXJIaXN0b3J5Lm9yZGVySWQnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJoYXNQT051bWJlclwiPlxuICAgICAgICAgICAgICAgICAgPHRoIHJvbGU9XCJjb2x1bW5oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5QT051bWJlcicgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgIDx0aCByb2xlPVwiY29sdW1uaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIHt7ICdvcmRlckhpc3RvcnkuY29zdENlbnRlcicgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8dGggcm9sZT1cImNvbHVtbmhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5kYXRlJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICA8dGggcm9sZT1cImNvbHVtbmhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5zdGF0dXMnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDx0aCByb2xlPVwiY29sdW1uaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICB7eyAnb3JkZXJIaXN0b3J5LnRvdGFsJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgIDx0clxuICAgICAgICAgICAgICAgIHJvbGU9XCJyb3dcIlxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBvcmRlciBvZiB0eXBlLm9yZGVySGlzdG9yeS5vcmRlcnNcIlxuICAgICAgICAgICAgICAgIChjbGljayk9XCJnb1RvT3JkZXJEZXRhaWwob3JkZXIpXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDx0ZCByb2xlPVwiY2VsbFwiIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1jb2RlXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7eyAnb3JkZXJIaXN0b3J5Lm9yZGVySWQnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3hSb3V0ZTogJ29yZGVyRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IG9yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgfSB8IGN4VXJsXG4gICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS12YWx1ZVwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHt7IG9yZGVyPy5jb2RlIH19PC9hXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaGFzUE9OdW1iZXJcIj5cbiAgICAgICAgICAgICAgICAgIDx0ZCByb2xlPVwiY2VsbFwiIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1wb1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHt7ICdvcmRlckhpc3RvcnkuUE9OdW1iZXInIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCJvcmRlci5wdXJjaGFzZU9yZGVyTnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICBbcm91dGVyTGlua109XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY3hSb3V0ZTogJ29yZGVyRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogb3JkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXZhbHVlXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIHt7IG9yZGVyLnB1cmNoYXNlT3JkZXJOdW1iZXIgfX08L2FcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgIDx0ZCByb2xlPVwiY2VsbFwiIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1jb3N0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHt7ICdvcmRlckhpc3RvcnkuY29zdENlbnRlcicgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAqbmdJZj1cIm9yZGVyLmNvc3RDZW50ZXI/Lm5hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjeFJvdXRlOiAnb3JkZXJEZXRhaWxzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBvcmRlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSB8IGN4VXJsXG4gICAgICAgICAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktdmFsdWVcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAge3sgb3JkZXIuY29zdENlbnRlcj8ubmFtZSB9fTwvYVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICAgICAgPHRkIHJvbGU9XCJjZWxsXCIgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXBsYWNlZFwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5kYXRlJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4Um91dGU6ICdvcmRlckRldGFpbHMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBvcmRlclxuICAgICAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktdmFsdWVcIlxuICAgICAgICAgICAgICAgICAgICA+e3sgb3JkZXI/LnBsYWNlZCB8IGN4RGF0ZTogJ2xvbmdEYXRlJyB9fTwvYVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPHRkIHJvbGU9XCJjZWxsXCIgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXN0YXR1c1wiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3sgJ29yZGVySGlzdG9yeS5zdGF0dXMnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwiXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3hSb3V0ZTogJ29yZGVyRGV0YWlscycsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IG9yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgfSB8IGN4VXJsXG4gICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS12YWx1ZVwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHt7XG4gICAgICAgICAgICAgICAgICAgICAgJ29yZGVyRGV0YWlscy5zdGF0dXNEaXNwbGF5XycgKyBvcmRlcj8uc3RhdHVzRGlzcGxheVxuICAgICAgICAgICAgICAgICAgICAgICAgfCBjeFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICB9fTwvYVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPHRkIHJvbGU9XCJjZWxsXCIgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXRvdGFsXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3gtb3JkZXItaGlzdG9yeS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7eyAnb3JkZXJIaXN0b3J5LnRvdGFsJyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIlxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN4Um91dGU6ICdvcmRlckRldGFpbHMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBvcmRlclxuICAgICAgICAgICAgICAgICAgICAgIH0gfCBjeFVybFxuICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImN4LW9yZGVyLWhpc3RvcnktdmFsdWVcIlxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7eyBvcmRlcj8udG90YWwuZm9ybWF0dGVkVmFsdWUgfX08L2FcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICA8L3RhYmxlPlxuXG4gICAgICAgICAgPCEtLSBTZWxlY3QgRm9ybSBhbmQgUGFnaW5hdGlvbiBCb3R0b20gLS0+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImN4LW9yZGVyLWhpc3Rvcnktc29ydCBib3R0b21cIj5cbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgKm5nSWY9XCJ0eXBlLm9yZGVySGlzdG9yeS5wYWdpbmF0aW9uLnRvdGFsUGFnZXMgPiAxXCJcbiAgICAgICAgICAgICAgY2xhc3M9XCJjeC1vcmRlci1oaXN0b3J5LXBhZ2luYXRpb25cIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8Y3gtcGFnaW5hdGlvblxuICAgICAgICAgICAgICAgIFtwYWdpbmF0aW9uXT1cInR5cGUub3JkZXJIaXN0b3J5LnBhZ2luYXRpb25cIlxuICAgICAgICAgICAgICAgICh2aWV3UGFnZUV2ZW50KT1cInBhZ2VDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAgID48L2N4LXBhZ2luYXRpb24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPCEtLSBOTyBPUkRFUiBDT05UQUlORVIgLS0+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjbm9PcmRlcj5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAqbmdJZj1cImlzTG9hZGVkJCB8IGFzeW5jXCJcbiAgICAgICAgICAgIFtuZ0NsYXNzXT1cIlxuICAgICAgICAgICAgICB0eXBlLnJlcGxlbmlzaG1lbnRPcmRlclxuICAgICAgICAgICAgICAgID8gJ2N4LXJlcGxlbmlzaG1lbnQtZGV0YWlscy1vcmRlci1oaXN0b3J5LW5vLW9yZGVyJ1xuICAgICAgICAgICAgICAgIDogJ2N4LW9yZGVyLWhpc3Rvcnktbm8tb3JkZXInXG4gICAgICAgICAgICBcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ0eXBlLnJlcGxlbmlzaG1lbnRPcmRlcjsgZWxzZSBvdGhlck9yZGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdj57eyAnb3JkZXJIaXN0b3J5Lm5vdEZvdW5kJyB8IGN4VHJhbnNsYXRlIH19PC9kaXY+XG4gICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjb3RoZXJPcmRlcj5cbiAgICAgICAgICAgICAgICA8ZGl2Pnt7ICdvcmRlckhpc3Rvcnkubm9PcmRlcnMnIHwgY3hUcmFuc2xhdGUgfX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgICAgW3JvdXRlckxpbmtdPVwieyBjeFJvdXRlOiAnaG9tZScgfSB8IGN4VXJsXCJcbiAgICAgICAgICAgICAgICAgIHJvdXRlckxpbmtBY3RpdmU9XCJhY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgID57eyAnb3JkZXJIaXN0b3J5LnN0YXJ0U2hvcHBpbmcnIHwgY3hUcmFuc2xhdGUgfX08L2FcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L25nLWNvbnRhaW5lcj5cbjwvbmctY29udGFpbmVyPlxuIl19