{"version":3,"file":"spartacus-cart-saved-cart-occ.mjs","sources":["../../../feature-libs/cart/saved-cart/occ/adapters/occ-saved-cart.adapter.ts","../../../feature-libs/cart/saved-cart/occ/adapters/index.ts","../../../feature-libs/cart/saved-cart/occ/model/occ-saved-cart-endpoints.model.ts","../../../feature-libs/cart/saved-cart/occ/model/index.ts","../../../feature-libs/cart/saved-cart/occ/config/default-occ-saved-cart-config.ts","../../../feature-libs/cart/saved-cart/occ/saved-cart-occ.module.ts","../../../feature-libs/cart/saved-cart/occ/public_api.ts","../../../feature-libs/cart/saved-cart/occ/spartacus-cart-saved-cart-occ.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Cart, CART_NORMALIZER } from '@spartacus/cart/base/root';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport { ConverterService, Occ, OccEndpointsService } from '@spartacus/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\n\n@Injectable()\nexport class OccSavedCartAdapter implements SavedCartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .get<Occ.Cart>(this.getSavedCartEndpoint(userId, cartId))\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  loadList(userId: string): Observable<Cart[]> {\n    return this.http\n      .get<Occ.CartList>(this.getSavedCartListEndpoint(userId))\n      .pipe(\n        pluck('carts'),\n        map((carts) => carts ?? []),\n        this.converter.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  restoreSavedCart(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .patch<Occ.Cart>(this.getRestoreSavedCartEndpoint(userId, cartId), cartId)\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  cloneSavedCart(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): Observable<Cart> {\n    return this.http\n      .post<Occ.Cart>(\n        this.getCloneSavedCartEndpoint(userId, cartId, saveCartName),\n        cartId\n      )\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  protected getSavedCartEndpoint(userId: string, cartId: string): string {\n    return this.occEndpoints.buildUrl('savedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getSavedCartListEndpoint(userId: string): string {\n    return this.occEndpoints.buildUrl('savedCarts', { urlParams: { userId } });\n  }\n\n  protected getRestoreSavedCartEndpoint(\n    userId: string,\n    cartId: string\n  ): string {\n    return this.occEndpoints.buildUrl('restoreSavedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getCloneSavedCartEndpoint(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): string {\n    return this.occEndpoints.buildUrl('cloneSavedCart', {\n      urlParams: { userId, cartId, saveCartName },\n    });\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './occ-saved-cart.adapter';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccEndpoint } from '@spartacus/core';\n\ndeclare module '@spartacus/core' {\n  interface OccEndpoints {\n    /**\n     * Endpoint to load saved carts\n     *\n     * * @member {string}\n     */\n    savedCarts?: string | OccEndpoint;\n    /**\n     * Endpoint to save a cart\n     *\n     * * @member {string}\n     */\n    saveCart?: string | OccEndpoint;\n    /**\n     * Endpoint to get specific saved cart\n     *\n     * * @member {string}\n     */\n    savedCart?: string | OccEndpoint;\n    /**\n     * Endpoint to make a saved cart active\n     *\n     * * @member {string}\n     */\n    restoreSavedCart?: string | OccEndpoint;\n    /**\n     * Endpoint to clone a saved cart\n     *\n     * * @member {string}\n     */\n    cloneSavedCart?: string | OccEndpoint;\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Imported for side effects (module augmentation)\nimport './occ-saved-cart-endpoints.model';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccConfig } from '@spartacus/core';\n\nexport const defaultOccSavedCartConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        savedCarts:\n          '/users/${userId}/carts?savedCartsOnly=true&fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name,description)',\n        savedCart: '/users/${userId}/carts/${cartId}/savedcart',\n        restoreSavedCart: '/users/${userId}/carts/${cartId}/restoresavedcart',\n        cloneSavedCart:\n          '/users/${userId}/carts/${cartId}/clonesavedcart?name=${saveCartName}',\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { OccSavedCartAdapter } from './adapters/occ-saved-cart.adapter';\nimport { defaultOccSavedCartConfig } from './config/default-occ-saved-cart-config';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccSavedCartConfig),\n    {\n      provide: SavedCartAdapter,\n      useClass: OccSavedCartAdapter,\n    },\n  ],\n})\nexport class SavedCartOccModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './adapters/index';\nexport * from './model/index';\nexport * from './saved-cart-occ.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}