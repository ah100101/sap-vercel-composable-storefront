/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component, ViewChild, } from '@angular/core';
import { GlobalMessageType, } from '@spartacus/core';
import { BehaviorSubject, combineLatest } from 'rxjs';
import { first, map, tap } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/cart/base/root";
import * as i2 from "@spartacus/storefront";
import * as i3 from "@spartacus/core";
import * as i4 from "@spartacus/cart/quick-order/root";
import * as i5 from "@spartacus/cart/quick-order/core";
import * as i6 from "@angular/common";
import * as i7 from "./form/quick-order-form.component";
import * as i8 from "./table/quick-order-table.component";
export class QuickOrderComponent {
    constructor(activeCartService, component, globalMessageService, quickOrderService, quickOrderStatePersistenceService) {
        this.activeCartService = activeCartService;
        this.component = component;
        this.globalMessageService = globalMessageService;
        this.quickOrderService = quickOrderService;
        this.quickOrderStatePersistenceService = quickOrderStatePersistenceService;
        this.quickOrderListLimit$ = this.component.data$.pipe(map((data) => data.quickOrderListLimit), tap((limit) => {
            if (!!limit) {
                this.quickOrderService.setListLimit(limit);
            }
        }));
        this.isCartStable$ = combineLatest([
            this.activeCartService.getActiveCartId(),
            this.activeCartService.isStable(),
        ]).pipe(map(([activeCartId, isStable]) => (!activeCartId ? true : isStable)));
        this.globalMessageType = GlobalMessageType;
        this.cartErrors$ = new BehaviorSubject([]);
        this.cartWarnings$ = new BehaviorSubject([]);
        this.cartSuccesses$ = new BehaviorSubject([]);
        this.showAddToCartInformation$ = new BehaviorSubject(false);
        this.nonPurchasableProductError$ = new BehaviorSubject(null);
    }
    ngOnInit() {
        this.cartId$ = this.activeCartService.getActiveCartId();
        this.entries$ = this.quickOrderService.getEntries();
        this.quickOrderStatePersistenceService.initSync();
    }
    ngOnDestroy() {
        this.quickOrderService.clearDeletedEntries();
    }
    get errors$() {
        return this.cartErrors$.asObservable();
    }
    get warnings$() {
        return this.cartWarnings$.asObservable();
    }
    get successes$() {
        return this.cartSuccesses$.asObservable();
    }
    get nonPurchasableError$() {
        return this.quickOrderService.getNonPurchasableProductError();
    }
    get addToCartInformation$() {
        return this.showAddToCartInformation$.asObservable();
    }
    get softDeletedEntries$() {
        return this.quickOrderService.getSoftDeletedEntries();
    }
    clear() {
        this.quickOrderService.clearList();
        this.globalMessageService.add({
            key: 'quickOrderTable.listCleared',
        }, GlobalMessageType.MSG_TYPE_INFO);
    }
    addToCart(orderEntries) {
        if (!orderEntries.length) {
            this.showAddToCartInformation$.next(true);
            return;
        }
        this.clearStatuses();
        this.quickOrderService
            .addToCart()
            .pipe(first())
            .subscribe(([entries, errors]) => {
            errors.forEach((err) => {
                if (!err.entry) {
                    err.entry = orderEntries.find((e) => e.product?.code === err.productCode);
                }
            });
            this.extractErrors(errors);
            this.extractWarnings(errors);
            if (!errors.length) {
                this.showAddedToCartSuccessMessage();
            }
            else {
                this.extractSuccesses(errors, entries);
            }
        });
    }
    clearErrors() {
        this.cartErrors$.next([]);
    }
    clearWarnings() {
        this.cartWarnings$.next([]);
    }
    clearSuccesses() {
        this.cartSuccesses$.next([]);
    }
    clearAddToCartInformation() {
        this.showAddToCartInformation$.next(false);
    }
    undoDeletion(entry) {
        if (entry.product?.code) {
            this.quickOrderService.restoreSoftDeletedEntry(entry.product.code);
        }
    }
    clearDeletion(entry) {
        if (entry.product?.code) {
            this.quickOrderService.hardDeleteEntry(entry.product.code);
        }
    }
    clearNonPurchasableError() {
        this.quickOrderService.clearNonPurchasableProductError();
    }
    canAddProduct() {
        return this.quickOrderService.canAdd();
    }
    extractErrors(errors) {
        const noAddedEntries = errors.filter((error) => error.quantityAdded === 0);
        this.setErrors(noAddedEntries);
    }
    extractWarnings(errors) {
        const warnings = errors.filter((error) => error.quantityAdded !== 0);
        this.setWarnings(warnings);
    }
    extractSuccesses(errors, entries) {
        const successAddedEntries = [];
        entries.forEach((entry) => {
            const element = errors.find((error) => error.productCode === entry.product?.code);
            if (!element) {
                successAddedEntries.push(entry);
            }
        });
        this.setSuccesses(successAddedEntries);
    }
    clearStatuses() {
        this.clearErrors();
        this.clearWarnings();
        this.clearSuccesses();
    }
    showAddedToCartSuccessMessage() {
        this.globalMessageService.add({
            key: 'quickOrderTable.addedtoCart',
        }, GlobalMessageType.MSG_TYPE_CONFIRMATION);
    }
    setErrors(errors) {
        this.cartErrors$.next(errors);
    }
    setWarnings(warnings) {
        this.cartWarnings$.next(warnings);
    }
    setSuccesses(entries) {
        this.cartSuccesses$.next(entries);
    }
}
QuickOrderComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: QuickOrderComponent, deps: [{ token: i1.ActiveCartFacade }, { token: i2.CmsComponentData }, { token: i3.GlobalMessageService }, { token: i4.QuickOrderFacade }, { token: i5.QuickOrderStatePersistenceService }], target: i0.ɵɵFactoryTarget.Component });
QuickOrderComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: QuickOrderComponent, selector: "cx-quick-order", viewQueries: [{ propertyName: "quickOrderForm", first: true, predicate: ["quickOrderForm"], descendants: true }], ngImport: i0, template: "<div\n  aria-atomic=\"true\"\n  aria-live=\"assertive\"\n  aria-relevant=\"additions\"\n  class=\"quick-order-message-container\"\n>\n  <ng-container *ngIf=\"entries$ | async as entries\">\n    <ng-container *ngIf=\"!(canAddProduct() | async)\">\n      <ng-container *ngIf=\"quickOrderForm?.form?.get('product')?.dirty\">\n        <cx-message\n          [text]=\"\n            'quickOrderList.errors.listIsFull'\n              | cxTranslate: { count: entries.length }\n          \"\n          [isVisibleCloseButton]=\"false\"\n          [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n          class=\"quick-order-list-limit-message\"\n        >\n        </cx-message>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n\n  <ng-container *ngIf=\"addToCartInformation$ | async\">\n    <cx-message\n      (closeMessage)=\"clearAddToCartInformation()\"\n      [text]=\"\n        'quickOrderList.informations.addProductBeforeAddingToCart' | cxTranslate\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-add-to-cart-information-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"nonPurchasableError$ | async as nonPurchasableError\">\n    <cx-message\n      (closeMessage)=\"clearNonPurchasableError()\"\n      [text]=\"\n        'quickOrderList.errors.nonPurchasableError'\n          | cxTranslate: { name: nonPurchasableError.name }\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-non-purchasable-product-error-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"softDeletedEntries$ | async as deletedEntries\">\n    <cx-message\n      *ngFor=\"let deletedEntry of deletedEntries | keyvalue\"\n      (buttonAction)=\"undoDeletion(deletedEntry.value)\"\n      (closeMessage)=\"clearDeletion(deletedEntry.value)\"\n      [actionButtonText]=\"'quickOrderList.undo' | cxTranslate\"\n      [actionButtonMessage]=\"\n        'quickOrderList.revokeUndo'\n          | cxTranslate: { name: deletedEntry.value.product?.name }\n      \"\n      [text]=\"\n        'quickOrderList.productWasDeleted'\n          | cxTranslate: { name: deletedEntry.value.product?.name }\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_CONFIRMATION\"\n      class=\"quick-order-deletions-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"errors$ | async as errors\">\n    <cx-message\n      *ngIf=\"errors.length\"\n      (closeMessage)=\"clearErrors()\"\n      [accordionText]=\"'quickOrderList.errors.reviewErrors' | cxTranslate\"\n      [text]=\"'quickOrderList.errorProceedingToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-errors-message\"\n    >\n      <ul class=\"quick-order-errors\">\n        <li *ngFor=\"let error of errors\" class=\"quick-order-error-item\">\n          <span>\n            {{\n              'quickOrderList.errors.productIsOutOfStock'\n                | cxTranslate\n                  : {\n                      name: error.entry.product.name,\n                      code: error.entry.product.code\n                    }\n            }}\n          </span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.errors.outOfStockErrorFound'\n            | cxTranslate: { count: errors.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"warnings$ | async as warnings\">\n    <cx-message\n      *ngIf=\"warnings.length\"\n      (closeMessage)=\"clearWarnings()\"\n      [accordionText]=\"'quickOrderList.warnings.reviewWarnings' | cxTranslate\"\n      [text]=\"'quickOrderList.warningProceedingToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_WARNING\"\n      class=\"quick-order-warnings-message\"\n    >\n      <ul class=\"quick-order-warnings\">\n        <li *ngFor=\"let warning of warnings\" class=\"quick-order-warning-item\">\n          <span>\n            {{\n              'quickOrderList.warnings.productWasReduced'\n                | cxTranslate\n                  : {\n                      name: warning.entry.product.name,\n                      code: warning.entry.product.code,\n                      quantityAdded: warning.quantityAdded\n                    }\n            }}\n          </span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.warnings.reduceWarningFound'\n            | cxTranslate: { count: warnings.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"successes$ | async as successes\">\n    <cx-message\n      *ngIf=\"successes.length\"\n      (closeMessage)=\"clearSuccesses()\"\n      [text]=\"'quickOrderList.successfullyAddedToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_CONFIRMATION\"\n      class=\"quick-order-successes-message\"\n    >\n      <ul class=\"quick-order-successes\">\n        <li *ngFor=\"let entry of successes\" class=\"quick-order-success-item\">\n          <span>{{\n            'quickOrderList.successes.productAddedToCart'\n              | cxTranslate\n                : {\n                    name: entry.product.name,\n                    code: entry.product.code\n                  }\n          }}</span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.successes.addedToCartFound'\n            | cxTranslate: { count: successes.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n</div>\n\n<ng-container *ngIf=\"quickOrderListLimit$ | async as quickOrderListLimit\">\n  <ng-container *ngIf=\"entries$ | async as entries\">\n    <div class=\"quick-order-header\">\n      <h2>\n        {{ 'quickOrderList.header' | cxTranslate }}\n      </h2>\n      <p>\n        {{\n          'quickOrderList.subHeader'\n            | cxTranslate: { limit: quickOrderListLimit }\n        }}\n      </p>\n    </div>\n\n    <div class=\"quick-order-form-body\">\n      <cx-quick-order-form #quickOrderForm [limit]=\"quickOrderListLimit\">\n      </cx-quick-order-form>\n    </div>\n\n    <div class=\"quick-order-table-body\">\n      <cx-quick-order-table\n        [entries]=\"entries\"\n        [loading]=\"!(isCartStable$ | async)\"\n      ></cx-quick-order-table>\n    </div>\n\n    <div class=\"quick-order-footer row\">\n      <div class=\"col-xs-12 col-md-5 col-lg-3\">\n        <button\n          *ngIf=\"entries.length\"\n          (click)=\"clear()\"\n          [attr.aria-label]=\"'quickOrderList.emptyList' | cxTranslate\"\n          [disabled]=\"!(isCartStable$ | async)\"\n          class=\"btn btn-block btn-secondary clear-button\"\n          type=\"button\"\n        >\n          {{ 'quickOrderList.emptyList' | cxTranslate }}\n        </button>\n      </div>\n\n      <div class=\"col-xs-12 col-md-5 col-lg-3\">\n        <cx-progress-button\n          (clickEvent)=\"addToCart(entries)\"\n          [ariaLabel]=\"'quickOrderList.addToCart' | cxTranslate\"\n          [class]=\"'btn-block add-button'\"\n          [loading]=\"!(isCartStable$ | async)\"\n        >\n          {{ 'quickOrderList.addToCart' | cxTranslate }}\n        </cx-progress-button>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n", dependencies: [{ kind: "directive", type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i2.MessageComponent, selector: "cx-message", inputs: ["text", "actionButtonText", "actionButtonMessage", "accordionText", "showBody", "isVisibleCloseButton", "type"], outputs: ["closeMessage", "buttonAction"] }, { kind: "component", type: i2.ProgressButtonComponent, selector: "cx-progress-button", inputs: ["ariaLabel", "class", "disabled", "loading"], outputs: ["clickEvent"] }, { kind: "component", type: i7.QuickOrderFormComponent, selector: "cx-quick-order-form", inputs: ["limit"] }, { kind: "component", type: i8.QuickOrderTableComponent, selector: "cx-quick-order-table", inputs: ["entries", "loading"] }, { kind: "pipe", type: i6.AsyncPipe, name: "async" }, { kind: "pipe", type: i6.KeyValuePipe, name: "keyvalue" }, { kind: "pipe", type: i3.TranslatePipe, name: "cxTranslate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: QuickOrderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-quick-order', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div\n  aria-atomic=\"true\"\n  aria-live=\"assertive\"\n  aria-relevant=\"additions\"\n  class=\"quick-order-message-container\"\n>\n  <ng-container *ngIf=\"entries$ | async as entries\">\n    <ng-container *ngIf=\"!(canAddProduct() | async)\">\n      <ng-container *ngIf=\"quickOrderForm?.form?.get('product')?.dirty\">\n        <cx-message\n          [text]=\"\n            'quickOrderList.errors.listIsFull'\n              | cxTranslate: { count: entries.length }\n          \"\n          [isVisibleCloseButton]=\"false\"\n          [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n          class=\"quick-order-list-limit-message\"\n        >\n        </cx-message>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n\n  <ng-container *ngIf=\"addToCartInformation$ | async\">\n    <cx-message\n      (closeMessage)=\"clearAddToCartInformation()\"\n      [text]=\"\n        'quickOrderList.informations.addProductBeforeAddingToCart' | cxTranslate\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-add-to-cart-information-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"nonPurchasableError$ | async as nonPurchasableError\">\n    <cx-message\n      (closeMessage)=\"clearNonPurchasableError()\"\n      [text]=\"\n        'quickOrderList.errors.nonPurchasableError'\n          | cxTranslate: { name: nonPurchasableError.name }\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-non-purchasable-product-error-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"softDeletedEntries$ | async as deletedEntries\">\n    <cx-message\n      *ngFor=\"let deletedEntry of deletedEntries | keyvalue\"\n      (buttonAction)=\"undoDeletion(deletedEntry.value)\"\n      (closeMessage)=\"clearDeletion(deletedEntry.value)\"\n      [actionButtonText]=\"'quickOrderList.undo' | cxTranslate\"\n      [actionButtonMessage]=\"\n        'quickOrderList.revokeUndo'\n          | cxTranslate: { name: deletedEntry.value.product?.name }\n      \"\n      [text]=\"\n        'quickOrderList.productWasDeleted'\n          | cxTranslate: { name: deletedEntry.value.product?.name }\n      \"\n      [type]=\"globalMessageType.MSG_TYPE_CONFIRMATION\"\n      class=\"quick-order-deletions-message\"\n    >\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"errors$ | async as errors\">\n    <cx-message\n      *ngIf=\"errors.length\"\n      (closeMessage)=\"clearErrors()\"\n      [accordionText]=\"'quickOrderList.errors.reviewErrors' | cxTranslate\"\n      [text]=\"'quickOrderList.errorProceedingToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_ERROR\"\n      class=\"quick-order-errors-message\"\n    >\n      <ul class=\"quick-order-errors\">\n        <li *ngFor=\"let error of errors\" class=\"quick-order-error-item\">\n          <span>\n            {{\n              'quickOrderList.errors.productIsOutOfStock'\n                | cxTranslate\n                  : {\n                      name: error.entry.product.name,\n                      code: error.entry.product.code\n                    }\n            }}\n          </span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.errors.outOfStockErrorFound'\n            | cxTranslate: { count: errors.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"warnings$ | async as warnings\">\n    <cx-message\n      *ngIf=\"warnings.length\"\n      (closeMessage)=\"clearWarnings()\"\n      [accordionText]=\"'quickOrderList.warnings.reviewWarnings' | cxTranslate\"\n      [text]=\"'quickOrderList.warningProceedingToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_WARNING\"\n      class=\"quick-order-warnings-message\"\n    >\n      <ul class=\"quick-order-warnings\">\n        <li *ngFor=\"let warning of warnings\" class=\"quick-order-warning-item\">\n          <span>\n            {{\n              'quickOrderList.warnings.productWasReduced'\n                | cxTranslate\n                  : {\n                      name: warning.entry.product.name,\n                      code: warning.entry.product.code,\n                      quantityAdded: warning.quantityAdded\n                    }\n            }}\n          </span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.warnings.reduceWarningFound'\n            | cxTranslate: { count: warnings.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n\n  <ng-container *ngIf=\"successes$ | async as successes\">\n    <cx-message\n      *ngIf=\"successes.length\"\n      (closeMessage)=\"clearSuccesses()\"\n      [text]=\"'quickOrderList.successfullyAddedToCart' | cxTranslate\"\n      [type]=\"globalMessageType.MSG_TYPE_CONFIRMATION\"\n      class=\"quick-order-successes-message\"\n    >\n      <ul class=\"quick-order-successes\">\n        <li *ngFor=\"let entry of successes\" class=\"quick-order-success-item\">\n          <span>{{\n            'quickOrderList.successes.productAddedToCart'\n              | cxTranslate\n                : {\n                    name: entry.product.name,\n                    code: entry.product.code\n                  }\n          }}</span>\n        </li>\n      </ul>\n      <div class=\"cx-visually-hidden\">\n        {{\n          'quickOrderList.successes.addedToCartFound'\n            | cxTranslate: { count: successes.length }\n        }}\n      </div>\n    </cx-message>\n  </ng-container>\n</div>\n\n<ng-container *ngIf=\"quickOrderListLimit$ | async as quickOrderListLimit\">\n  <ng-container *ngIf=\"entries$ | async as entries\">\n    <div class=\"quick-order-header\">\n      <h2>\n        {{ 'quickOrderList.header' | cxTranslate }}\n      </h2>\n      <p>\n        {{\n          'quickOrderList.subHeader'\n            | cxTranslate: { limit: quickOrderListLimit }\n        }}\n      </p>\n    </div>\n\n    <div class=\"quick-order-form-body\">\n      <cx-quick-order-form #quickOrderForm [limit]=\"quickOrderListLimit\">\n      </cx-quick-order-form>\n    </div>\n\n    <div class=\"quick-order-table-body\">\n      <cx-quick-order-table\n        [entries]=\"entries\"\n        [loading]=\"!(isCartStable$ | async)\"\n      ></cx-quick-order-table>\n    </div>\n\n    <div class=\"quick-order-footer row\">\n      <div class=\"col-xs-12 col-md-5 col-lg-3\">\n        <button\n          *ngIf=\"entries.length\"\n          (click)=\"clear()\"\n          [attr.aria-label]=\"'quickOrderList.emptyList' | cxTranslate\"\n          [disabled]=\"!(isCartStable$ | async)\"\n          class=\"btn btn-block btn-secondary clear-button\"\n          type=\"button\"\n        >\n          {{ 'quickOrderList.emptyList' | cxTranslate }}\n        </button>\n      </div>\n\n      <div class=\"col-xs-12 col-md-5 col-lg-3\">\n        <cx-progress-button\n          (clickEvent)=\"addToCart(entries)\"\n          [ariaLabel]=\"'quickOrderList.addToCart' | cxTranslate\"\n          [class]=\"'btn-block add-button'\"\n          [loading]=\"!(isCartStable$ | async)\"\n        >\n          {{ 'quickOrderList.addToCart' | cxTranslate }}\n        </cx-progress-button>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n" }]
        }], ctorParameters: function () { return [{ type: i1.ActiveCartFacade }, { type: i2.CmsComponentData }, { type: i3.GlobalMessageService }, { type: i4.QuickOrderFacade }, { type: i5.QuickOrderStatePersistenceService }]; }, propDecorators: { quickOrderForm: [{
                type: ViewChild,
                args: ['quickOrderForm']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVpY2stb3JkZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL2NhcnQvcXVpY2stb3JkZXIvY29tcG9uZW50cy9xdWljay1vcmRlci9xdWljay1vcmRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9mZWF0dXJlLWxpYnMvY2FydC9xdWljay1vcmRlci9jb21wb25lbnRzL3F1aWNrLW9yZGVyL3F1aWNrLW9yZGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0dBSUc7QUFFSCxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFHVCxTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFVdkIsT0FBTyxFQUVMLGlCQUFpQixHQUVsQixNQUFNLGlCQUFpQixDQUFDO0FBRXpCLE9BQU8sRUFBRSxlQUFlLEVBQUUsYUFBYSxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7Ozs7O0FBUWpELE1BQU0sT0FBTyxtQkFBbUI7SUE4QjlCLFlBQ1ksaUJBQW1DLEVBQ25DLFNBQW1ELEVBQ25ELG9CQUEwQyxFQUMxQyxpQkFBbUMsRUFDbkMsaUNBQW9FO1FBSnBFLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBa0I7UUFDbkMsY0FBUyxHQUFULFNBQVMsQ0FBMEM7UUFDbkQseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFzQjtRQUMxQyxzQkFBaUIsR0FBakIsaUJBQWlCLENBQWtCO1FBQ25DLHNDQUFpQyxHQUFqQyxpQ0FBaUMsQ0FBbUM7UUFoQ2hGLHlCQUFvQixHQUNsQixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQ3ZCLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLG1CQUFt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LEtBQUssS0FBSyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQ3JELENBQUM7WUFDRixJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNaLG1CQUFtQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFUyxhQUFhO1FBQ3JCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNuQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFUyw2QkFBNkI7UUFDckMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FDM0I7WUFDRSxHQUFHLEVBQUUsNkJBQTZCO1NBQ25DLEVBQ0QsaUJBQWlCLENBQUMscUJBQXFCLENBQ3hDLENBQUM7SUFDSixDQUFDO0lBRVMsU0FBUyxDQUFDLE1BQWlDO1FBQ25ELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFUyxXQUFXLENBQUMsUUFBbUM7UUFDdkQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVTLFlBQVksQ0FBQyxPQUFxQjtRQUMxQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwQyxDQUFDOztnSEE1TVUsbUJBQW1CO29HQUFuQixtQkFBbUIsd0tDckNoQyxrck9Bd05BOzJGRG5MYSxtQkFBbUI7a0JBTC9CLFNBQVM7K0JBQ0UsZ0JBQWdCLG1CQUVULHVCQUF1QixDQUFDLE1BQU07d1BBc0IvQyxjQUFjO3NCQURiLFNBQVM7dUJBQUMsZ0JBQWdCIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIFNQRFgtRmlsZUNvcHlyaWdodFRleHQ6IDIwMjMgU0FQIFNwYXJ0YWN1cyB0ZWFtIDxzcGFydGFjdXMtdGVhbUBzYXAuY29tPlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHtcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBY3RpdmVDYXJ0RmFjYWRlLCBPcmRlckVudHJ5IH0gZnJvbSAnQHNwYXJ0YWN1cy9jYXJ0L2Jhc2Uvcm9vdCc7XG5pbXBvcnQge1xuICBDbXNRdWlja09yZGVyQ29tcG9uZW50LFxuICBRdWlja09yZGVyU3RhdGVQZXJzaXN0ZW5jZVNlcnZpY2UsXG59IGZyb20gJ0BzcGFydGFjdXMvY2FydC9xdWljay1vcmRlci9jb3JlJztcbmltcG9ydCB7XG4gIFF1aWNrT3JkZXJBZGRFbnRyeUV2ZW50LFxuICBRdWlja09yZGVyRmFjYWRlLFxufSBmcm9tICdAc3BhcnRhY3VzL2NhcnQvcXVpY2stb3JkZXIvcm9vdCc7XG5pbXBvcnQge1xuICBHbG9iYWxNZXNzYWdlU2VydmljZSxcbiAgR2xvYmFsTWVzc2FnZVR5cGUsXG4gIFByb2R1Y3QsXG59IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQgeyBDbXNDb21wb25lbnREYXRhIH0gZnJvbSAnQHNwYXJ0YWN1cy9zdG9yZWZyb250JztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgY29tYmluZUxhdGVzdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlyc3QsIG1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgUXVpY2tPcmRlckZvcm1Db21wb25lbnQgfSBmcm9tICcuL2Zvcm0vcXVpY2stb3JkZXItZm9ybS5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjeC1xdWljay1vcmRlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9xdWljay1vcmRlci5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBRdWlja09yZGVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuICBjYXJ0SWQkOiBPYnNlcnZhYmxlPHN0cmluZz47XG4gIGVudHJpZXMkOiBPYnNlcnZhYmxlPE9yZGVyRW50cnlbXT47XG4gIHF1aWNrT3JkZXJMaXN0TGltaXQkOiBPYnNlcnZhYmxlPG51bWJlciB8IHVuZGVmaW5lZD4gPVxuICAgIHRoaXMuY29tcG9uZW50LmRhdGEkLnBpcGUoXG4gICAgICBtYXAoKGRhdGEpID0+IGRhdGEucXVpY2tPcmRlckxpc3RMaW1pdCksXG4gICAgICB0YXAoKGxpbWl0KSA9PiB7XG4gICAgICAgIGlmICghIWxpbWl0KSB7XG4gICAgICAgICAgdGhpcy5xdWlja09yZGVyU2VydmljZS5zZXRMaXN0TGltaXQobGltaXQpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG4gIGlzQ2FydFN0YWJsZSQ6IE9ic2VydmFibGU8Ym9vbGVhbj4gPSBjb21iaW5lTGF0ZXN0KFtcbiAgICB0aGlzLmFjdGl2ZUNhcnRTZXJ2aWNlLmdldEFjdGl2ZUNhcnRJZCgpLFxuICAgIHRoaXMuYWN0aXZlQ2FydFNlcnZpY2UuaXNTdGFibGUoKSxcbiAgXSkucGlwZShtYXAoKFthY3RpdmVDYXJ0SWQsIGlzU3RhYmxlXSkgPT4gKCFhY3RpdmVDYXJ0SWQgPyB0cnVlIDogaXNTdGFibGUpKSk7XG4gIGdsb2JhbE1lc3NhZ2VUeXBlID0gR2xvYmFsTWVzc2FnZVR5cGU7XG4gIGxpc3RMaW1pdFJlYWNoZWQkOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xuXG4gIEBWaWV3Q2hpbGQoJ3F1aWNrT3JkZXJGb3JtJylcbiAgcXVpY2tPcmRlckZvcm06IFF1aWNrT3JkZXJGb3JtQ29tcG9uZW50O1xuXG4gIHByb3RlY3RlZCBjYXJ0RXJyb3JzJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8UXVpY2tPcmRlckFkZEVudHJ5RXZlbnRbXT4oW10pO1xuICBwcm90ZWN0ZWQgY2FydFdhcm5pbmdzJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8UXVpY2tPcmRlckFkZEVudHJ5RXZlbnRbXT4oW10pO1xuICBwcm90ZWN0ZWQgY2FydFN1Y2Nlc3NlcyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PE9yZGVyRW50cnlbXT4oW10pO1xuICBwcm90ZWN0ZWQgc2hvd0FkZFRvQ2FydEluZm9ybWF0aW9uJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj4oZmFsc2UpO1xuICBwcm90ZWN0ZWQgbm9uUHVyY2hhc2FibGVQcm9kdWN0RXJyb3IkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxQcm9kdWN0IHwgbnVsbD4oXG4gICAgbnVsbFxuICApO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBhY3RpdmVDYXJ0U2VydmljZTogQWN0aXZlQ2FydEZhY2FkZSxcbiAgICBwcm90ZWN0ZWQgY29tcG9uZW50OiBDbXNDb21wb25lbnREYXRhPENtc1F1aWNrT3JkZXJDb21wb25lbnQ+LFxuICAgIHByb3RlY3RlZCBnbG9iYWxNZXNzYWdlU2VydmljZTogR2xvYmFsTWVzc2FnZVNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIHF1aWNrT3JkZXJTZXJ2aWNlOiBRdWlja09yZGVyRmFjYWRlLFxuICAgIHByb3RlY3RlZCBxdWlja09yZGVyU3RhdGVQZXJzaXN0ZW5jZVNlcnZpY2U6IFF1aWNrT3JkZXJTdGF0ZVBlcnNpc3RlbmNlU2VydmljZVxuICApIHt9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5jYXJ0SWQkID0gdGhpcy5hY3RpdmVDYXJ0U2VydmljZS5nZXRBY3RpdmVDYXJ0SWQoKTtcbiAgICB0aGlzLmVudHJpZXMkID0gdGhpcy5xdWlja09yZGVyU2VydmljZS5nZXRFbnRyaWVzKCk7XG4gICAgdGhpcy5xdWlja09yZGVyU3RhdGVQZXJzaXN0ZW5jZVNlcnZpY2UuaW5pdFN5bmMoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMucXVpY2tPcmRlclNlcnZpY2UuY2xlYXJEZWxldGVkRW50cmllcygpO1xuICB9XG5cbiAgZ2V0IGVycm9ycyQoKTogT2JzZXJ2YWJsZTxRdWlja09yZGVyQWRkRW50cnlFdmVudFtdPiB7XG4gICAgcmV0dXJuIHRoaXMuY2FydEVycm9ycyQuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBnZXQgd2FybmluZ3MkKCk6IE9ic2VydmFibGU8UXVpY2tPcmRlckFkZEVudHJ5RXZlbnRbXT4ge1xuICAgIHJldHVybiB0aGlzLmNhcnRXYXJuaW5ncyQuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBnZXQgc3VjY2Vzc2VzJCgpOiBPYnNlcnZhYmxlPE9yZGVyRW50cnlbXT4ge1xuICAgIHJldHVybiB0aGlzLmNhcnRTdWNjZXNzZXMkLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgZ2V0IG5vblB1cmNoYXNhYmxlRXJyb3IkKCk6IE9ic2VydmFibGU8UHJvZHVjdCB8IG51bGw+IHtcbiAgICByZXR1cm4gdGhpcy5xdWlja09yZGVyU2VydmljZS5nZXROb25QdXJjaGFzYWJsZVByb2R1Y3RFcnJvcigpO1xuICB9XG5cbiAgZ2V0IGFkZFRvQ2FydEluZm9ybWF0aW9uJCgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gdGhpcy5zaG93QWRkVG9DYXJ0SW5mb3JtYXRpb24kLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgZ2V0IHNvZnREZWxldGVkRW50cmllcyQoKTogT2JzZXJ2YWJsZTxSZWNvcmQ8c3RyaW5nLCBPcmRlckVudHJ5Pj4ge1xuICAgIHJldHVybiB0aGlzLnF1aWNrT3JkZXJTZXJ2aWNlLmdldFNvZnREZWxldGVkRW50cmllcygpO1xuICB9XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5xdWlja09yZGVyU2VydmljZS5jbGVhckxpc3QoKTtcbiAgICB0aGlzLmdsb2JhbE1lc3NhZ2VTZXJ2aWNlLmFkZChcbiAgICAgIHtcbiAgICAgICAga2V5OiAncXVpY2tPcmRlclRhYmxlLmxpc3RDbGVhcmVkJyxcbiAgICAgIH0sXG4gICAgICBHbG9iYWxNZXNzYWdlVHlwZS5NU0dfVFlQRV9JTkZPXG4gICAgKTtcbiAgfVxuXG4gIGFkZFRvQ2FydChvcmRlckVudHJpZXM6IE9yZGVyRW50cnlbXSk6IHZvaWQge1xuICAgIGlmICghb3JkZXJFbnRyaWVzLmxlbmd0aCkge1xuICAgICAgdGhpcy5zaG93QWRkVG9DYXJ0SW5mb3JtYXRpb24kLm5leHQodHJ1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhclN0YXR1c2VzKCk7XG5cbiAgICB0aGlzLnF1aWNrT3JkZXJTZXJ2aWNlXG4gICAgICAuYWRkVG9DYXJ0KClcbiAgICAgIC5waXBlKGZpcnN0KCkpXG4gICAgICAuc3Vic2NyaWJlKChbZW50cmllcywgZXJyb3JzXSkgPT4ge1xuICAgICAgICBlcnJvcnMuZm9yRWFjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgaWYgKCFlcnIuZW50cnkpIHtcbiAgICAgICAgICAgIGVyci5lbnRyeSA9IG9yZGVyRW50cmllcy5maW5kKFxuICAgICAgICAgICAgICAoZSkgPT4gZS5wcm9kdWN0Py5jb2RlID09PSBlcnIucHJvZHVjdENvZGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmV4dHJhY3RFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgdGhpcy5leHRyYWN0V2FybmluZ3MoZXJyb3JzKTtcblxuICAgICAgICBpZiAoIWVycm9ycy5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnNob3dBZGRlZFRvQ2FydFN1Y2Nlc3NNZXNzYWdlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5leHRyYWN0U3VjY2Vzc2VzKGVycm9ycywgZW50cmllcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgY2xlYXJFcnJvcnMoKTogdm9pZCB7XG4gICAgdGhpcy5jYXJ0RXJyb3JzJC5uZXh0KFtdKTtcbiAgfVxuXG4gIGNsZWFyV2FybmluZ3MoKTogdm9pZCB7XG4gICAgdGhpcy5jYXJ0V2FybmluZ3MkLm5leHQoW10pO1xuICB9XG5cbiAgY2xlYXJTdWNjZXNzZXMoKTogdm9pZCB7XG4gICAgdGhpcy5jYXJ0U3VjY2Vzc2VzJC5uZXh0KFtdKTtcbiAgfVxuXG4gIGNsZWFyQWRkVG9DYXJ0SW5mb3JtYXRpb24oKTogdm9pZCB7XG4gICAgdGhpcy5zaG93QWRkVG9DYXJ0SW5mb3JtYXRpb24kLm5leHQoZmFsc2UpO1xuICB9XG5cbiAgdW5kb0RlbGV0aW9uKGVudHJ5OiBPcmRlckVudHJ5KTogdm9pZCB7XG4gICAgaWYgKGVudHJ5LnByb2R1Y3Q/LmNvZGUpIHtcbiAgICAgIHRoaXMucXVpY2tPcmRlclNlcnZpY2UucmVzdG9yZVNvZnREZWxldGVkRW50cnkoZW50cnkucHJvZHVjdC5jb2RlKTtcbiAgICB9XG4gIH1cblxuICBjbGVhckRlbGV0aW9uKGVudHJ5OiBPcmRlckVudHJ5KTogdm9pZCB7XG4gICAgaWYgKGVudHJ5LnByb2R1Y3Q/LmNvZGUpIHtcbiAgICAgIHRoaXMucXVpY2tPcmRlclNlcnZpY2UuaGFyZERlbGV0ZUVudHJ5KGVudHJ5LnByb2R1Y3QuY29kZSk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJOb25QdXJjaGFzYWJsZUVycm9yKCk6IHZvaWQge1xuICAgIHRoaXMucXVpY2tPcmRlclNlcnZpY2UuY2xlYXJOb25QdXJjaGFzYWJsZVByb2R1Y3RFcnJvcigpO1xuICB9XG5cbiAgY2FuQWRkUHJvZHVjdCgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gdGhpcy5xdWlja09yZGVyU2VydmljZS5jYW5BZGQoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBleHRyYWN0RXJyb3JzKGVycm9yczogUXVpY2tPcmRlckFkZEVudHJ5RXZlbnRbXSk6IHZvaWQge1xuICAgIGNvbnN0IG5vQWRkZWRFbnRyaWVzID0gZXJyb3JzLmZpbHRlcigoZXJyb3IpID0+IGVycm9yLnF1YW50aXR5QWRkZWQgPT09IDApO1xuXG4gICAgdGhpcy5zZXRFcnJvcnMobm9BZGRlZEVudHJpZXMpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGV4dHJhY3RXYXJuaW5ncyhlcnJvcnM6IFF1aWNrT3JkZXJBZGRFbnRyeUV2ZW50W10pOiB2b2lkIHtcbiAgICBjb25zdCB3YXJuaW5ncyA9IGVycm9ycy5maWx0ZXIoKGVycm9yKSA9PiBlcnJvci5xdWFudGl0eUFkZGVkICE9PSAwKTtcblxuICAgIHRoaXMuc2V0V2FybmluZ3Mod2FybmluZ3MpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGV4dHJhY3RTdWNjZXNzZXMoXG4gICAgZXJyb3JzOiBRdWlja09yZGVyQWRkRW50cnlFdmVudFtdLFxuICAgIGVudHJpZXM6IE9yZGVyRW50cnlbXVxuICApOiB2b2lkIHtcbiAgICBjb25zdCBzdWNjZXNzQWRkZWRFbnRyaWVzOiBPcmRlckVudHJ5W10gPSBbXTtcblxuICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBlcnJvcnMuZmluZChcbiAgICAgICAgKGVycm9yKSA9PiBlcnJvci5wcm9kdWN0Q29kZSA9PT0gZW50cnkucHJvZHVjdD8uY29kZVxuICAgICAgKTtcbiAgICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICBzdWNjZXNzQWRkZWRFbnRyaWVzLnB1c2goZW50cnkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRTdWNjZXNzZXMoc3VjY2Vzc0FkZGVkRW50cmllcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgY2xlYXJTdGF0dXNlcygpOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyRXJyb3JzKCk7XG4gICAgdGhpcy5jbGVhcldhcm5pbmdzKCk7XG4gICAgdGhpcy5jbGVhclN1Y2Nlc3NlcygpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNob3dBZGRlZFRvQ2FydFN1Y2Nlc3NNZXNzYWdlKCk6IHZvaWQge1xuICAgIHRoaXMuZ2xvYmFsTWVzc2FnZVNlcnZpY2UuYWRkKFxuICAgICAge1xuICAgICAgICBrZXk6ICdxdWlja09yZGVyVGFibGUuYWRkZWR0b0NhcnQnLFxuICAgICAgfSxcbiAgICAgIEdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0NPTkZJUk1BVElPTlxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2V0RXJyb3JzKGVycm9yczogUXVpY2tPcmRlckFkZEVudHJ5RXZlbnRbXSk6IHZvaWQge1xuICAgIHRoaXMuY2FydEVycm9ycyQubmV4dChlcnJvcnMpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNldFdhcm5pbmdzKHdhcm5pbmdzOiBRdWlja09yZGVyQWRkRW50cnlFdmVudFtdKTogdm9pZCB7XG4gICAgdGhpcy5jYXJ0V2FybmluZ3MkLm5leHQod2FybmluZ3MpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNldFN1Y2Nlc3NlcyhlbnRyaWVzOiBPcmRlckVudHJ5W10pOiB2b2lkIHtcbiAgICB0aGlzLmNhcnRTdWNjZXNzZXMkLm5leHQoZW50cmllcyk7XG4gIH1cbn1cbiIsIjxkaXZcbiAgYXJpYS1hdG9taWM9XCJ0cnVlXCJcbiAgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCJcbiAgYXJpYS1yZWxldmFudD1cImFkZGl0aW9uc1wiXG4gIGNsYXNzPVwicXVpY2stb3JkZXItbWVzc2FnZS1jb250YWluZXJcIlxuPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiZW50cmllcyQgfCBhc3luYyBhcyBlbnRyaWVzXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiEoY2FuQWRkUHJvZHVjdCgpIHwgYXN5bmMpXCI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwicXVpY2tPcmRlckZvcm0/LmZvcm0/LmdldCgncHJvZHVjdCcpPy5kaXJ0eVwiPlxuICAgICAgICA8Y3gtbWVzc2FnZVxuICAgICAgICAgIFt0ZXh0XT1cIlxuICAgICAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LmVycm9ycy5saXN0SXNGdWxsJ1xuICAgICAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IGNvdW50OiBlbnRyaWVzLmxlbmd0aCB9XG4gICAgICAgICAgXCJcbiAgICAgICAgICBbaXNWaXNpYmxlQ2xvc2VCdXR0b25dPVwiZmFsc2VcIlxuICAgICAgICAgIFt0eXBlXT1cImdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0VSUk9SXCJcbiAgICAgICAgICBjbGFzcz1cInF1aWNrLW9yZGVyLWxpc3QtbGltaXQtbWVzc2FnZVwiXG4gICAgICAgID5cbiAgICAgICAgPC9jeC1tZXNzYWdlPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvbmctY29udGFpbmVyPlxuXG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCJhZGRUb0NhcnRJbmZvcm1hdGlvbiQgfCBhc3luY1wiPlxuICAgIDxjeC1tZXNzYWdlXG4gICAgICAoY2xvc2VNZXNzYWdlKT1cImNsZWFyQWRkVG9DYXJ0SW5mb3JtYXRpb24oKVwiXG4gICAgICBbdGV4dF09XCJcbiAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LmluZm9ybWF0aW9ucy5hZGRQcm9kdWN0QmVmb3JlQWRkaW5nVG9DYXJ0JyB8IGN4VHJhbnNsYXRlXG4gICAgICBcIlxuICAgICAgW3R5cGVdPVwiZ2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcIlxuICAgICAgY2xhc3M9XCJxdWljay1vcmRlci1hZGQtdG8tY2FydC1pbmZvcm1hdGlvbi1tZXNzYWdlXCJcbiAgICA+XG4gICAgPC9jeC1tZXNzYWdlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwibm9uUHVyY2hhc2FibGVFcnJvciQgfCBhc3luYyBhcyBub25QdXJjaGFzYWJsZUVycm9yXCI+XG4gICAgPGN4LW1lc3NhZ2VcbiAgICAgIChjbG9zZU1lc3NhZ2UpPVwiY2xlYXJOb25QdXJjaGFzYWJsZUVycm9yKClcIlxuICAgICAgW3RleHRdPVwiXG4gICAgICAgICdxdWlja09yZGVyTGlzdC5lcnJvcnMubm9uUHVyY2hhc2FibGVFcnJvcidcbiAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IG5hbWU6IG5vblB1cmNoYXNhYmxlRXJyb3IubmFtZSB9XG4gICAgICBcIlxuICAgICAgW3R5cGVdPVwiZ2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcIlxuICAgICAgY2xhc3M9XCJxdWljay1vcmRlci1ub24tcHVyY2hhc2FibGUtcHJvZHVjdC1lcnJvci1tZXNzYWdlXCJcbiAgICA+XG4gICAgPC9jeC1tZXNzYWdlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwic29mdERlbGV0ZWRFbnRyaWVzJCB8IGFzeW5jIGFzIGRlbGV0ZWRFbnRyaWVzXCI+XG4gICAgPGN4LW1lc3NhZ2VcbiAgICAgICpuZ0Zvcj1cImxldCBkZWxldGVkRW50cnkgb2YgZGVsZXRlZEVudHJpZXMgfCBrZXl2YWx1ZVwiXG4gICAgICAoYnV0dG9uQWN0aW9uKT1cInVuZG9EZWxldGlvbihkZWxldGVkRW50cnkudmFsdWUpXCJcbiAgICAgIChjbG9zZU1lc3NhZ2UpPVwiY2xlYXJEZWxldGlvbihkZWxldGVkRW50cnkudmFsdWUpXCJcbiAgICAgIFthY3Rpb25CdXR0b25UZXh0XT1cIidxdWlja09yZGVyTGlzdC51bmRvJyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgIFthY3Rpb25CdXR0b25NZXNzYWdlXT1cIlxuICAgICAgICAncXVpY2tPcmRlckxpc3QucmV2b2tlVW5kbydcbiAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IG5hbWU6IGRlbGV0ZWRFbnRyeS52YWx1ZS5wcm9kdWN0Py5uYW1lIH1cbiAgICAgIFwiXG4gICAgICBbdGV4dF09XCJcbiAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LnByb2R1Y3RXYXNEZWxldGVkJ1xuICAgICAgICAgIHwgY3hUcmFuc2xhdGU6IHsgbmFtZTogZGVsZXRlZEVudHJ5LnZhbHVlLnByb2R1Y3Q/Lm5hbWUgfVxuICAgICAgXCJcbiAgICAgIFt0eXBlXT1cImdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0NPTkZJUk1BVElPTlwiXG4gICAgICBjbGFzcz1cInF1aWNrLW9yZGVyLWRlbGV0aW9ucy1tZXNzYWdlXCJcbiAgICA+XG4gICAgPC9jeC1tZXNzYWdlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiZXJyb3JzJCB8IGFzeW5jIGFzIGVycm9yc1wiPlxuICAgIDxjeC1tZXNzYWdlXG4gICAgICAqbmdJZj1cImVycm9ycy5sZW5ndGhcIlxuICAgICAgKGNsb3NlTWVzc2FnZSk9XCJjbGVhckVycm9ycygpXCJcbiAgICAgIFthY2NvcmRpb25UZXh0XT1cIidxdWlja09yZGVyTGlzdC5lcnJvcnMucmV2aWV3RXJyb3JzJyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgIFt0ZXh0XT1cIidxdWlja09yZGVyTGlzdC5lcnJvclByb2NlZWRpbmdUb0NhcnQnIHwgY3hUcmFuc2xhdGVcIlxuICAgICAgW3R5cGVdPVwiZ2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcIlxuICAgICAgY2xhc3M9XCJxdWljay1vcmRlci1lcnJvcnMtbWVzc2FnZVwiXG4gICAgPlxuICAgICAgPHVsIGNsYXNzPVwicXVpY2stb3JkZXItZXJyb3JzXCI+XG4gICAgICAgIDxsaSAqbmdGb3I9XCJsZXQgZXJyb3Igb2YgZXJyb3JzXCIgY2xhc3M9XCJxdWljay1vcmRlci1lcnJvci1pdGVtXCI+XG4gICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICB7e1xuICAgICAgICAgICAgICAncXVpY2tPcmRlckxpc3QuZXJyb3JzLnByb2R1Y3RJc091dE9mU3RvY2snXG4gICAgICAgICAgICAgICAgfCBjeFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogZXJyb3IuZW50cnkucHJvZHVjdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGVycm9yLmVudHJ5LnByb2R1Y3QuY29kZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9fVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPC9saT5cbiAgICAgIDwvdWw+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtdmlzdWFsbHktaGlkZGVuXCI+XG4gICAgICAgIHt7XG4gICAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LmVycm9ycy5vdXRPZlN0b2NrRXJyb3JGb3VuZCdcbiAgICAgICAgICAgIHwgY3hUcmFuc2xhdGU6IHsgY291bnQ6IGVycm9ycy5sZW5ndGggfVxuICAgICAgICB9fVxuICAgICAgPC9kaXY+XG4gICAgPC9jeC1tZXNzYWdlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwid2FybmluZ3MkIHwgYXN5bmMgYXMgd2FybmluZ3NcIj5cbiAgICA8Y3gtbWVzc2FnZVxuICAgICAgKm5nSWY9XCJ3YXJuaW5ncy5sZW5ndGhcIlxuICAgICAgKGNsb3NlTWVzc2FnZSk9XCJjbGVhcldhcm5pbmdzKClcIlxuICAgICAgW2FjY29yZGlvblRleHRdPVwiJ3F1aWNrT3JkZXJMaXN0Lndhcm5pbmdzLnJldmlld1dhcm5pbmdzJyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgIFt0ZXh0XT1cIidxdWlja09yZGVyTGlzdC53YXJuaW5nUHJvY2VlZGluZ1RvQ2FydCcgfCBjeFRyYW5zbGF0ZVwiXG4gICAgICBbdHlwZV09XCJnbG9iYWxNZXNzYWdlVHlwZS5NU0dfVFlQRV9XQVJOSU5HXCJcbiAgICAgIGNsYXNzPVwicXVpY2stb3JkZXItd2FybmluZ3MtbWVzc2FnZVwiXG4gICAgPlxuICAgICAgPHVsIGNsYXNzPVwicXVpY2stb3JkZXItd2FybmluZ3NcIj5cbiAgICAgICAgPGxpICpuZ0Zvcj1cImxldCB3YXJuaW5nIG9mIHdhcm5pbmdzXCIgY2xhc3M9XCJxdWljay1vcmRlci13YXJuaW5nLWl0ZW1cIj5cbiAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgIHt7XG4gICAgICAgICAgICAgICdxdWlja09yZGVyTGlzdC53YXJuaW5ncy5wcm9kdWN0V2FzUmVkdWNlZCdcbiAgICAgICAgICAgICAgICB8IGN4VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB3YXJuaW5nLmVudHJ5LnByb2R1Y3QubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICBjb2RlOiB3YXJuaW5nLmVudHJ5LnByb2R1Y3QuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eUFkZGVkOiB3YXJuaW5nLnF1YW50aXR5QWRkZWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvbGk+XG4gICAgICA8L3VsPlxuICAgICAgPGRpdiBjbGFzcz1cImN4LXZpc3VhbGx5LWhpZGRlblwiPlxuICAgICAgICB7e1xuICAgICAgICAgICdxdWlja09yZGVyTGlzdC53YXJuaW5ncy5yZWR1Y2VXYXJuaW5nRm91bmQnXG4gICAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IGNvdW50OiB3YXJuaW5ncy5sZW5ndGggfVxuICAgICAgICB9fVxuICAgICAgPC9kaXY+XG4gICAgPC9jeC1tZXNzYWdlPlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwic3VjY2Vzc2VzJCB8IGFzeW5jIGFzIHN1Y2Nlc3Nlc1wiPlxuICAgIDxjeC1tZXNzYWdlXG4gICAgICAqbmdJZj1cInN1Y2Nlc3Nlcy5sZW5ndGhcIlxuICAgICAgKGNsb3NlTWVzc2FnZSk9XCJjbGVhclN1Y2Nlc3NlcygpXCJcbiAgICAgIFt0ZXh0XT1cIidxdWlja09yZGVyTGlzdC5zdWNjZXNzZnVsbHlBZGRlZFRvQ2FydCcgfCBjeFRyYW5zbGF0ZVwiXG4gICAgICBbdHlwZV09XCJnbG9iYWxNZXNzYWdlVHlwZS5NU0dfVFlQRV9DT05GSVJNQVRJT05cIlxuICAgICAgY2xhc3M9XCJxdWljay1vcmRlci1zdWNjZXNzZXMtbWVzc2FnZVwiXG4gICAgPlxuICAgICAgPHVsIGNsYXNzPVwicXVpY2stb3JkZXItc3VjY2Vzc2VzXCI+XG4gICAgICAgIDxsaSAqbmdGb3I9XCJsZXQgZW50cnkgb2Ygc3VjY2Vzc2VzXCIgY2xhc3M9XCJxdWljay1vcmRlci1zdWNjZXNzLWl0ZW1cIj5cbiAgICAgICAgICA8c3Bhbj57e1xuICAgICAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LnN1Y2Nlc3Nlcy5wcm9kdWN0QWRkZWRUb0NhcnQnXG4gICAgICAgICAgICAgIHwgY3hUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogZW50cnkucHJvZHVjdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBlbnRyeS5wcm9kdWN0LmNvZGVcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICB9fTwvc3Bhbj5cbiAgICAgICAgPC9saT5cbiAgICAgIDwvdWw+XG4gICAgICA8ZGl2IGNsYXNzPVwiY3gtdmlzdWFsbHktaGlkZGVuXCI+XG4gICAgICAgIHt7XG4gICAgICAgICAgJ3F1aWNrT3JkZXJMaXN0LnN1Y2Nlc3Nlcy5hZGRlZFRvQ2FydEZvdW5kJ1xuICAgICAgICAgICAgfCBjeFRyYW5zbGF0ZTogeyBjb3VudDogc3VjY2Vzc2VzLmxlbmd0aCB9XG4gICAgICAgIH19XG4gICAgICA8L2Rpdj5cbiAgICA8L2N4LW1lc3NhZ2U+XG4gIDwvbmctY29udGFpbmVyPlxuPC9kaXY+XG5cbjxuZy1jb250YWluZXIgKm5nSWY9XCJxdWlja09yZGVyTGlzdExpbWl0JCB8IGFzeW5jIGFzIHF1aWNrT3JkZXJMaXN0TGltaXRcIj5cbiAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImVudHJpZXMkIHwgYXN5bmMgYXMgZW50cmllc1wiPlxuICAgIDxkaXYgY2xhc3M9XCJxdWljay1vcmRlci1oZWFkZXJcIj5cbiAgICAgIDxoMj5cbiAgICAgICAge3sgJ3F1aWNrT3JkZXJMaXN0LmhlYWRlcicgfCBjeFRyYW5zbGF0ZSB9fVxuICAgICAgPC9oMj5cbiAgICAgIDxwPlxuICAgICAgICB7e1xuICAgICAgICAgICdxdWlja09yZGVyTGlzdC5zdWJIZWFkZXInXG4gICAgICAgICAgICB8IGN4VHJhbnNsYXRlOiB7IGxpbWl0OiBxdWlja09yZGVyTGlzdExpbWl0IH1cbiAgICAgICAgfX1cbiAgICAgIDwvcD5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJxdWljay1vcmRlci1mb3JtLWJvZHlcIj5cbiAgICAgIDxjeC1xdWljay1vcmRlci1mb3JtICNxdWlja09yZGVyRm9ybSBbbGltaXRdPVwicXVpY2tPcmRlckxpc3RMaW1pdFwiPlxuICAgICAgPC9jeC1xdWljay1vcmRlci1mb3JtPlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cInF1aWNrLW9yZGVyLXRhYmxlLWJvZHlcIj5cbiAgICAgIDxjeC1xdWljay1vcmRlci10YWJsZVxuICAgICAgICBbZW50cmllc109XCJlbnRyaWVzXCJcbiAgICAgICAgW2xvYWRpbmddPVwiIShpc0NhcnRTdGFibGUkIHwgYXN5bmMpXCJcbiAgICAgID48L2N4LXF1aWNrLW9yZGVyLXRhYmxlPlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cInF1aWNrLW9yZGVyLWZvb3RlciByb3dcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2wteHMtMTIgY29sLW1kLTUgY29sLWxnLTNcIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICpuZ0lmPVwiZW50cmllcy5sZW5ndGhcIlxuICAgICAgICAgIChjbGljayk9XCJjbGVhcigpXCJcbiAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIidxdWlja09yZGVyTGlzdC5lbXB0eUxpc3QnIHwgY3hUcmFuc2xhdGVcIlxuICAgICAgICAgIFtkaXNhYmxlZF09XCIhKGlzQ2FydFN0YWJsZSQgfCBhc3luYylcIlxuICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1ibG9jayBidG4tc2Vjb25kYXJ5IGNsZWFyLWJ1dHRvblwiXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgID5cbiAgICAgICAgICB7eyAncXVpY2tPcmRlckxpc3QuZW1wdHlMaXN0JyB8IGN4VHJhbnNsYXRlIH19XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2wteHMtMTIgY29sLW1kLTUgY29sLWxnLTNcIj5cbiAgICAgICAgPGN4LXByb2dyZXNzLWJ1dHRvblxuICAgICAgICAgIChjbGlja0V2ZW50KT1cImFkZFRvQ2FydChlbnRyaWVzKVwiXG4gICAgICAgICAgW2FyaWFMYWJlbF09XCIncXVpY2tPcmRlckxpc3QuYWRkVG9DYXJ0JyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgICAgICBbY2xhc3NdPVwiJ2J0bi1ibG9jayBhZGQtYnV0dG9uJ1wiXG4gICAgICAgICAgW2xvYWRpbmddPVwiIShpc0NhcnRTdGFibGUkIHwgYXN5bmMpXCJcbiAgICAgICAgPlxuICAgICAgICAgIHt7ICdxdWlja09yZGVyTGlzdC5hZGRUb0NhcnQnIHwgY3hUcmFuc2xhdGUgfX1cbiAgICAgICAgPC9jeC1wcm9ncmVzcy1idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9uZy1jb250YWluZXI+XG48L25nLWNvbnRhaW5lcj5cbiJdfQ==