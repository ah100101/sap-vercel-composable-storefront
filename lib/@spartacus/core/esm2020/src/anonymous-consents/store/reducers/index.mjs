/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { InjectionToken } from '@angular/core';
import { combineReducers, } from '@ngrx/store';
import { AuthActions } from '../../../auth/index';
import { SiteContextActions } from '../../../site-context/index';
import { loaderReducer } from '../../../state/utils/loader/loader.reducer';
import { ANONYMOUS_CONSENTS, } from '../anonymous-consents-state';
import * as fromAnonymousConsentsBanner from './anonymous-consents-banner.reducer';
import * as fromAnonymousConsentsUpdate from './anonymous-consents-update.reducer';
import * as fromAnonymousConsents from './anonymous-consents.reducer';
export function getReducers() {
    return {
        templates: loaderReducer(ANONYMOUS_CONSENTS),
        consents: fromAnonymousConsents.reducer,
        ui: combineReducers({
            bannerDismissed: fromAnonymousConsentsBanner.reducer,
            updated: fromAnonymousConsentsUpdate.reducer,
        }),
    };
}
export const reducerToken = new InjectionToken('AnonymousConsentsReducers');
export const reducerProvider = {
    provide: reducerToken,
    useFactory: getReducers,
};
export function clearAnonymousConsentTemplates(reducer) {
    return function (state, action) {
        if (state !== undefined &&
            (action.type === AuthActions.LOGOUT ||
                action.type === SiteContextActions.LANGUAGE_CHANGE)) {
            state = {
                ...state,
                templates: {},
            };
        }
        return reducer(state, action);
    };
}
export const metaReducers = [
    clearAnonymousConsentTemplates,
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb3JlL3NyYy9hbm9ueW1vdXMtY29uc2VudHMvc3RvcmUvcmVkdWNlcnMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFBRSxjQUFjLEVBQVksTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUlMLGVBQWUsR0FFaEIsTUFBTSxhQUFhLENBQUM7QUFDckIsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRWxELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUMzRSxPQUFPLEVBRUwsa0JBQWtCLEdBQ25CLE1BQU0sNkJBQTZCLENBQUM7QUFDckMsT0FBTyxLQUFLLDJCQUEyQixNQUFNLHFDQUFxQyxDQUFDO0FBQ25GLE9BQU8sS0FBSywyQkFBMkIsTUFBTSxxQ0FBcUMsQ0FBQztBQUNuRixPQUFPLEtBQUsscUJBQXFCLE1BQU0sOEJBQThCLENBQUM7QUFFdEUsTUFBTSxVQUFVLFdBQVc7SUFDekIsT0FBTztRQUNMLFNBQVMsRUFBRSxhQUFhLENBQW9CLGtCQUFrQixDQUFDO1FBQy9ELFFBQVEsRUFBRSxxQkFBcUIsQ0FBQyxPQUFPO1FBQ3ZDLEVBQUUsRUFBRSxlQUFlLENBQUM7WUFDbEIsZUFBZSxFQUFFLDJCQUEyQixDQUFDLE9BQU87WUFDcEQsT0FBTyxFQUFFLDJCQUEyQixDQUFDLE9BQU87U0FDN0MsQ0FBQztLQUNILENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUVyQixJQUFJLGNBQWMsQ0FDcEIsMkJBQTJCLENBQzVCLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxlQUFlLEdBQWE7SUFDdkMsT0FBTyxFQUFFLFlBQVk7SUFDckIsVUFBVSxFQUFFLFdBQVc7Q0FDeEIsQ0FBQztBQUVGLE1BQU0sVUFBVSw4QkFBOEIsQ0FDNUMsT0FBc0Q7SUFFdEQsT0FBTyxVQUFVLEtBQUssRUFBRSxNQUFNO1FBQzVCLElBQ0UsS0FBSyxLQUFLLFNBQVM7WUFDbkIsQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLFdBQVcsQ0FBQyxNQUFNO2dCQUNqQyxNQUFNLENBQUMsSUFBSSxLQUFLLGtCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUNyRDtZQUNBLEtBQUssR0FBRztnQkFDTixHQUFHLEtBQUs7Z0JBQ1IsU0FBUyxFQUFFLEVBQUU7YUFDZCxDQUFDO1NBQ0g7UUFDRCxPQUFPLE9BQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDaEMsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBdUI7SUFDOUMsOEJBQThCO0NBQy9CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogU1BEWC1GaWxlQ29weXJpZ2h0VGV4dDogMjAyMyBTQVAgU3BhcnRhY3VzIHRlYW0gPHNwYXJ0YWN1cy10ZWFtQHNhcC5jb20+XG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQgeyBJbmplY3Rpb25Ub2tlbiwgUHJvdmlkZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFjdGlvbixcbiAgQWN0aW9uUmVkdWNlcixcbiAgQWN0aW9uUmVkdWNlck1hcCxcbiAgY29tYmluZVJlZHVjZXJzLFxuICBNZXRhUmVkdWNlcixcbn0gZnJvbSAnQG5ncngvc3RvcmUnO1xuaW1wb3J0IHsgQXV0aEFjdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9hdXRoL2luZGV4JztcbmltcG9ydCB7IENvbnNlbnRUZW1wbGF0ZSB9IGZyb20gJy4uLy4uLy4uL21vZGVsL2NvbnNlbnQubW9kZWwnO1xuaW1wb3J0IHsgU2l0ZUNvbnRleHRBY3Rpb25zIH0gZnJvbSAnLi4vLi4vLi4vc2l0ZS1jb250ZXh0L2luZGV4JztcbmltcG9ydCB7IGxvYWRlclJlZHVjZXIgfSBmcm9tICcuLi8uLi8uLi9zdGF0ZS91dGlscy9sb2FkZXIvbG9hZGVyLnJlZHVjZXInO1xuaW1wb3J0IHtcbiAgQW5vbnltb3VzQ29uc2VudHNTdGF0ZSxcbiAgQU5PTllNT1VTX0NPTlNFTlRTLFxufSBmcm9tICcuLi9hbm9ueW1vdXMtY29uc2VudHMtc3RhdGUnO1xuaW1wb3J0ICogYXMgZnJvbUFub255bW91c0NvbnNlbnRzQmFubmVyIGZyb20gJy4vYW5vbnltb3VzLWNvbnNlbnRzLWJhbm5lci5yZWR1Y2VyJztcbmltcG9ydCAqIGFzIGZyb21Bbm9ueW1vdXNDb25zZW50c1VwZGF0ZSBmcm9tICcuL2Fub255bW91cy1jb25zZW50cy11cGRhdGUucmVkdWNlcic7XG5pbXBvcnQgKiBhcyBmcm9tQW5vbnltb3VzQ29uc2VudHMgZnJvbSAnLi9hbm9ueW1vdXMtY29uc2VudHMucmVkdWNlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWR1Y2VycygpOiBBY3Rpb25SZWR1Y2VyTWFwPEFub255bW91c0NvbnNlbnRzU3RhdGUsIGFueT4ge1xuICByZXR1cm4ge1xuICAgIHRlbXBsYXRlczogbG9hZGVyUmVkdWNlcjxDb25zZW50VGVtcGxhdGVbXT4oQU5PTllNT1VTX0NPTlNFTlRTKSxcbiAgICBjb25zZW50czogZnJvbUFub255bW91c0NvbnNlbnRzLnJlZHVjZXIsXG4gICAgdWk6IGNvbWJpbmVSZWR1Y2Vycyh7XG4gICAgICBiYW5uZXJEaXNtaXNzZWQ6IGZyb21Bbm9ueW1vdXNDb25zZW50c0Jhbm5lci5yZWR1Y2VyLFxuICAgICAgdXBkYXRlZDogZnJvbUFub255bW91c0NvbnNlbnRzVXBkYXRlLnJlZHVjZXIsXG4gICAgfSksXG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCByZWR1Y2VyVG9rZW46IEluamVjdGlvblRva2VuPFxuICBBY3Rpb25SZWR1Y2VyTWFwPEFub255bW91c0NvbnNlbnRzU3RhdGU+XG4+ID0gbmV3IEluamVjdGlvblRva2VuPEFjdGlvblJlZHVjZXJNYXA8QW5vbnltb3VzQ29uc2VudHNTdGF0ZT4+KFxuICAnQW5vbnltb3VzQ29uc2VudHNSZWR1Y2Vycydcbik7XG5cbmV4cG9ydCBjb25zdCByZWR1Y2VyUHJvdmlkZXI6IFByb3ZpZGVyID0ge1xuICBwcm92aWRlOiByZWR1Y2VyVG9rZW4sXG4gIHVzZUZhY3Rvcnk6IGdldFJlZHVjZXJzLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyQW5vbnltb3VzQ29uc2VudFRlbXBsYXRlcyhcbiAgcmVkdWNlcjogQWN0aW9uUmVkdWNlcjxBbm9ueW1vdXNDb25zZW50c1N0YXRlLCBBY3Rpb24+XG4pOiBBY3Rpb25SZWR1Y2VyPEFub255bW91c0NvbnNlbnRzU3RhdGUsIEFjdGlvbj4ge1xuICByZXR1cm4gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICBpZiAoXG4gICAgICBzdGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAoYWN0aW9uLnR5cGUgPT09IEF1dGhBY3Rpb25zLkxPR09VVCB8fFxuICAgICAgICBhY3Rpb24udHlwZSA9PT0gU2l0ZUNvbnRleHRBY3Rpb25zLkxBTkdVQUdFX0NIQU5HRSlcbiAgICApIHtcbiAgICAgIHN0YXRlID0ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgdGVtcGxhdGVzOiB7fSxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiByZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xuICB9O1xufVxuXG5leHBvcnQgY29uc3QgbWV0YVJlZHVjZXJzOiBNZXRhUmVkdWNlcjxhbnk+W10gPSBbXG4gIGNsZWFyQW5vbnltb3VzQ29uc2VudFRlbXBsYXRlcyxcbl07XG4iXX0=