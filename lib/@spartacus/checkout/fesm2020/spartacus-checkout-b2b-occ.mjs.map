{"version":3,"file":"spartacus-checkout-b2b-occ.mjs","sources":["../../../feature-libs/checkout/b2b/occ/adapters/occ-checkout-cost-center.adapter.ts","../../../feature-libs/checkout/b2b/occ/adapters/occ-checkout-payment-type.adapter.ts","../../../feature-libs/checkout/b2b/occ/adapters/index.ts","../../../feature-libs/checkout/b2b/occ/config/default-occ-checkout-b2b-config.ts","../../../feature-libs/checkout/b2b/occ/checkout-b2b-occ.module.ts","../../../feature-libs/checkout/b2b/occ/model/occ-checkout-b2b-endpoints.model.ts","../../../feature-libs/checkout/b2b/occ/model/index.ts","../../../feature-libs/checkout/b2b/occ/public_api.ts","../../../feature-libs/checkout/b2b/occ/spartacus-checkout-b2b-occ.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Cart, CART_NORMALIZER } from '@spartacus/cart/base/root';\nimport { CheckoutCostCenterAdapter } from '@spartacus/checkout/b2b/core';\nimport {\n  backOff,\n  ConverterService,\n  isJaloError,\n  normalizeHttpError,\n  OccEndpointsService,\n} from '@spartacus/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\n@Injectable()\nexport class OccCheckoutCostCenterAdapter implements CheckoutCostCenterAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  setCostCenter(\n    userId: string,\n    cartId: string,\n    costCenterId: string\n  ): Observable<Cart> {\n    return this.http\n      .put(this.getSetCartCostCenterEndpoint(userId, cartId, costCenterId), {})\n      .pipe(\n        catchError((error) => throwError(normalizeHttpError(error))),\n        backOff({ shouldRetry: isJaloError }),\n        this.converter.pipeable(CART_NORMALIZER)\n      );\n  }\n\n  protected getSetCartCostCenterEndpoint(\n    userId: string,\n    cartId: string,\n    costCenterId: string\n  ): string {\n    return this.occEndpoints.buildUrl('setCartCostCenter', {\n      urlParams: { userId, cartId },\n      queryParams: { costCenterId },\n    });\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { HttpClient, HttpContext } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Cart, CART_NORMALIZER, PaymentType } from '@spartacus/cart/base/root';\nimport {\n  CheckoutPaymentTypeAdapter,\n  CHECKOUT_PAYMENT_TYPE_NORMALIZER,\n} from '@spartacus/checkout/b2b/core';\nimport {\n  backOff,\n  ConverterService,\n  isJaloError,\n  normalizeHttpError,\n  Occ,\n  OccEndpointsService,\n  OCC_HTTP_TOKEN,\n} from '@spartacus/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\n\n@Injectable()\nexport class OccCheckoutPaymentTypeAdapter\n  implements CheckoutPaymentTypeAdapter\n{\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  getPaymentTypes(): Observable<PaymentType[]> {\n    const context = new HttpContext().set(OCC_HTTP_TOKEN, {\n      sendUserIdAsHeader: true,\n    });\n\n    return this.http\n      .get<Occ.PaymentTypeList>(this.getPaymentTypesEndpoint(), { context })\n      .pipe(\n        catchError((error) => throwError(normalizeHttpError(error))),\n        backOff({ shouldRetry: isJaloError }),\n        map((paymentTypeList) => paymentTypeList.paymentTypes ?? []),\n        this.converter.pipeableMany(CHECKOUT_PAYMENT_TYPE_NORMALIZER)\n      );\n  }\n\n  protected getPaymentTypesEndpoint(): string {\n    return this.occEndpoints.buildUrl('paymentTypes');\n  }\n\n  setPaymentType(\n    userId: string,\n    cartId: string,\n    paymentType: string,\n    purchaseOrderNumber?: string\n  ): Observable<Cart> {\n    return this.http\n      .put(\n        this.getSetCartPaymentTypeEndpoint(\n          userId,\n          cartId,\n          paymentType,\n          purchaseOrderNumber\n        ),\n        {}\n      )\n      .pipe(\n        catchError((error) => throwError(normalizeHttpError(error))),\n        backOff({ shouldRetry: isJaloError }),\n        this.converter.pipeable(CART_NORMALIZER)\n      );\n  }\n\n  protected getSetCartPaymentTypeEndpoint(\n    userId: string,\n    cartId: string,\n    paymentType: string,\n    purchaseOrderNumber?: string\n  ): string {\n    const queryParams = { paymentType, purchaseOrderNumber };\n    return this.occEndpoints.buildUrl('setCartPaymentType', {\n      urlParams: { userId, cartId },\n      queryParams,\n    });\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './occ-checkout-cost-center.adapter';\nexport * from './occ-checkout-payment-type.adapter';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// We need these imports for augmentation of OccEndpoints to be picked up\nimport { CheckoutOccEndpoints } from '@spartacus/checkout/base/occ';\nimport { OccConfig } from '@spartacus/core';\n\nconst defaultB2bCheckoutDetailsOccEndpoint: CheckoutOccEndpoints = {\n  getCheckoutDetails:\n    'users/${userId}/carts/${cartId}?fields=deliveryAddress(FULL),deliveryMode(FULL),paymentInfo(FULL),costCenter(FULL),purchaseOrderNumber,paymentType(FULL)',\n};\n\nexport const defaultOccCheckoutB2BConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        ...defaultB2bCheckoutDetailsOccEndpoint,\n        setDeliveryAddress:\n          'orgUsers/${userId}/carts/${cartId}/addresses/delivery',\n        paymentTypes: 'paymenttypes',\n        setCartCostCenter: 'users/${userId}/carts/${cartId}/costcenter',\n        setCartPaymentType: 'users/${userId}/carts/${cartId}/paymenttype',\n      },\n    },\n  },\n};\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport {\n  CheckoutCostCenterAdapter,\n  CheckoutPaymentTypeAdapter,\n} from '@spartacus/checkout/b2b/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { OccCheckoutCostCenterAdapter } from './adapters/occ-checkout-cost-center.adapter';\nimport { OccCheckoutPaymentTypeAdapter } from './adapters/occ-checkout-payment-type.adapter';\nimport { defaultOccCheckoutB2BConfig } from './config/default-occ-checkout-b2b-config';\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccCheckoutB2BConfig),\n    {\n      provide: CheckoutPaymentTypeAdapter,\n      useClass: OccCheckoutPaymentTypeAdapter,\n    },\n    {\n      provide: CheckoutCostCenterAdapter,\n      useClass: OccCheckoutCostCenterAdapter,\n    },\n  ],\n})\nexport class CheckoutB2BOccModule {}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { OccEndpoint } from '@spartacus/core';\n\nexport interface CheckoutB2BOccEndpoints {\n  /**\n   * Returns a list of the available payment types.\n   */\n  paymentTypes?: string | OccEndpoint;\n  /**\n   * Sets the cost center for the checkout cart.\n   */\n  setCartCostCenter?: string | OccEndpoint;\n  /**\n   * Sets the payment type for the checkout cart\n   */\n  setCartPaymentType?: string | OccEndpoint;\n}\n\ndeclare module '@spartacus/core' {\n  interface OccEndpoints extends CheckoutB2BOccEndpoints {}\n}\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './occ-checkout-b2b-endpoints.model';\n","/*\n * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from './adapters/index';\nexport * from './checkout-b2b-occ.module';\nexport * from './model/index';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":";;;;;;;;;;;;MAqBa,4BAA4B,CAAA;AACvC,IAAA,WAAA,CACY,IAAgB,EAChB,YAAiC,EACjC,SAA2B,EAAA;QAF3B,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAY;QAChB,IAAY,CAAA,YAAA,GAAZ,YAAY,CAAqB;QACjC,IAAS,CAAA,SAAA,GAAT,SAAS,CAAkB;KACnC;AAEJ,IAAA,aAAa,CACX,MAAc,EACd,MAAc,EACd,YAAoB,EAAA;QAEpB,OAAO,IAAI,CAAC,IAAI;AACb,aAAA,GAAG,CAAC,IAAI,CAAC,4BAA4B,CAAC,MAAM,EAAE,MAAM,EAAE,YAAY,CAAC,EAAE,EAAE,CAAC;AACxE,aAAA,IAAI,CACH,UAAU,CAAC,CAAC,KAAK,KAAK,UAAU,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,EAC5D,OAAO,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,CAAC,EACrC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,eAAe,CAAC,CACzC,CAAC;KACL;AAES,IAAA,4BAA4B,CACpC,MAAc,EACd,MAAc,EACd,YAAoB,EAAA;AAEpB,QAAA,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,mBAAmB,EAAE;AACrD,YAAA,SAAS,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE;YAC7B,WAAW,EAAE,EAAE,YAAY,EAAE;AAC9B,SAAA,CAAC,CAAC;KACJ;;yHA9BU,4BAA4B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,mBAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,gBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;6HAA5B,4BAA4B,EAAA,CAAA,CAAA;2FAA5B,4BAA4B,EAAA,UAAA,EAAA,CAAA;kBADxC,UAAU;;;ACpBX;;;;AAIG;MAsBU,6BAA6B,CAAA;AAGxC,IAAA,WAAA,CACY,IAAgB,EAChB,YAAiC,EACjC,SAA2B,EAAA;QAF3B,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAY;QAChB,IAAY,CAAA,YAAA,GAAZ,YAAY,CAAqB;QACjC,IAAS,CAAA,SAAA,GAAT,SAAS,CAAkB;KACnC;IAEJ,eAAe,GAAA;QACb,MAAM,OAAO,GAAG,IAAI,WAAW,EAAE,CAAC,GAAG,CAAC,cAAc,EAAE;AACpD,YAAA,kBAAkB,EAAE,IAAI;AACzB,SAAA,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC,IAAI;aACb,GAAG,CAAsB,IAAI,CAAC,uBAAuB,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC;aACrE,IAAI,CACH,UAAU,CAAC,CAAC,KAAK,KAAK,UAAU,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,EAC5D,OAAO,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,CAAC,EACrC,GAAG,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,YAAY,IAAI,EAAE,CAAC,EAC5D,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,gCAAgC,CAAC,CAC9D,CAAC;KACL;IAES,uBAAuB,GAAA;QAC/B,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;KACnD;AAED,IAAA,cAAc,CACZ,MAAc,EACd,MAAc,EACd,WAAmB,EACnB,mBAA4B,EAAA;QAE5B,OAAO,IAAI,CAAC,IAAI;AACb,aAAA,GAAG,CACF,IAAI,CAAC,6BAA6B,CAChC,MAAM,EACN,MAAM,EACN,WAAW,EACX,mBAAmB,CACpB,EACD,EAAE,CACH;AACA,aAAA,IAAI,CACH,UAAU,CAAC,CAAC,KAAK,KAAK,UAAU,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,EAC5D,OAAO,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,CAAC,EACrC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,eAAe,CAAC,CACzC,CAAC;KACL;AAES,IAAA,6BAA6B,CACrC,MAAc,EACd,MAAc,EACd,WAAmB,EACnB,mBAA4B,EAAA;AAE5B,QAAA,MAAM,WAAW,GAAG,EAAE,WAAW,EAAE,mBAAmB,EAAE,CAAC;AACzD,QAAA,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,oBAAoB,EAAE;AACtD,YAAA,SAAS,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE;YAC7B,WAAW;AACZ,SAAA,CAAC,CAAC;KACJ;;0HA9DU,6BAA6B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,mBAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,gBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;8HAA7B,6BAA6B,EAAA,CAAA,CAAA;2FAA7B,6BAA6B,EAAA,UAAA,EAAA,CAAA;kBADzC,UAAU;;;ACzBX;;;;AAIG;;ACJH;;;;AAIG;AAMH,MAAM,oCAAoC,GAAyB;AACjE,IAAA,kBAAkB,EAChB,0JAA0J;CAC7J,CAAC;AAEK,MAAM,2BAA2B,GAAc;AACpD,IAAA,OAAO,EAAE;AACP,QAAA,GAAG,EAAE;AACH,YAAA,SAAS,EAAE;AACT,gBAAA,GAAG,oCAAoC;AACvC,gBAAA,kBAAkB,EAChB,uDAAuD;AACzD,gBAAA,YAAY,EAAE,cAAc;AAC5B,gBAAA,iBAAiB,EAAE,4CAA4C;AAC/D,gBAAA,kBAAkB,EAAE,6CAA6C;AAClE,aAAA;AACF,SAAA;AACF,KAAA;CACF;;AC5BD;;;;AAIG;MA0BU,oBAAoB,CAAA;;iHAApB,oBAAoB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA;AAApB,oBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,oBAAoB,YAbrB,YAAY,CAAA,EAAA,CAAA,CAAA;AAaX,oBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,oBAAoB,EAZpB,SAAA,EAAA;QACT,oBAAoB,CAAC,2BAA2B,CAAC;AACjD,QAAA;AACE,YAAA,OAAO,EAAE,0BAA0B;AACnC,YAAA,QAAQ,EAAE,6BAA6B;AACxC,SAAA;AACD,QAAA;AACE,YAAA,OAAO,EAAE,yBAAyB;AAClC,YAAA,QAAQ,EAAE,4BAA4B;AACvC,SAAA;AACF,KAAA,EAAA,OAAA,EAAA,CAXS,YAAY,CAAA,EAAA,CAAA,CAAA;2FAaX,oBAAoB,EAAA,UAAA,EAAA,CAAA;kBAdhC,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;oBACR,OAAO,EAAE,CAAC,YAAY,CAAC;AACvB,oBAAA,SAAS,EAAE;wBACT,oBAAoB,CAAC,2BAA2B,CAAC;AACjD,wBAAA;AACE,4BAAA,OAAO,EAAE,0BAA0B;AACnC,4BAAA,QAAQ,EAAE,6BAA6B;AACxC,yBAAA;AACD,wBAAA;AACE,4BAAA,OAAO,EAAE,yBAAyB;AAClC,4BAAA,QAAQ,EAAE,4BAA4B;AACvC,yBAAA;AACF,qBAAA;AACF,iBAAA,CAAA;;;AC7BD;;;;AAIG;;ACJH;;;;AAIG;;ACJH;;;;AAIG;;ACJH;;AAEG;;;;"}