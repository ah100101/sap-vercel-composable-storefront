/*
 * SPDX-FileCopyrightText: 2023 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
import { ChangeDetectionStrategy, Component } from '@angular/core';
import { billingAddressCard, paymentMethodCard } from '@spartacus/order/root';
import { ICON_TYPE } from '@spartacus/storefront';
import { combineLatest } from 'rxjs';
import { filter, map } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "../../services/checkout-step.service";
import * as i2 from "@spartacus/checkout/base/root";
import * as i3 from "@spartacus/core";
import * as i4 from "@angular/common";
import * as i5 from "@spartacus/storefront";
import * as i6 from "@angular/router";
export class CheckoutReviewPaymentComponent {
    constructor(checkoutStepService, checkoutPaymentFacade, translationService) {
        this.checkoutStepService = checkoutStepService;
        this.checkoutPaymentFacade = checkoutPaymentFacade;
        this.translationService = translationService;
        this.iconTypes = ICON_TYPE;
        this.paymentDetailsStepRoute = this.checkoutStepService.getCheckoutStepRoute("paymentDetails" /* CheckoutStepType.PAYMENT_DETAILS */);
        this.paymentDetails$ = this.checkoutPaymentFacade.getPaymentDetailsState().pipe(filter((state) => !state.loading && !state.error), map((state) => state.data));
    }
    getPaymentMethodCard(paymentDetails) {
        return combineLatest([
            this.translationService.translate('paymentForm.payment'),
            this.translationService.translate('paymentCard.expires', {
                month: paymentDetails.expiryMonth,
                year: paymentDetails.expiryYear,
            }),
        ]).pipe(map(([textTitle, textExpires]) => paymentMethodCard(textTitle, textExpires, paymentDetails)));
    }
    getBillingAddressCard(paymentDetails) {
        return combineLatest([
            this.translationService.translate('paymentForm.billingAddress'),
            this.translationService.translate('addressCard.billTo'),
        ]).pipe(map(([billingAddress, billTo]) => billingAddressCard(billingAddress, billTo, paymentDetails)));
    }
}
CheckoutReviewPaymentComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: CheckoutReviewPaymentComponent, deps: [{ token: i1.CheckoutStepService }, { token: i2.CheckoutPaymentFacade }, { token: i3.TranslationService }], target: i0.ɵɵFactoryTarget.Component });
CheckoutReviewPaymentComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: CheckoutReviewPaymentComponent, selector: "cx-checkout-review-payment", ngImport: i0, template: "<div\n  class=\"cx-review-summary\"\n  *ngIf=\"paymentDetails$ | async as paymentDetails\"\n>\n  <div class=\"cx-review-summary-card cx-review-summary-payment-card\">\n    <div>\n      <cx-card\n        [content]=\"getBillingAddressCard(paymentDetails) | async\"\n      ></cx-card>\n    </div>\n    <div class=\"cx-review-summary-edit-step\">\n      <a\n        [attr.aria-label]=\"'checkoutReview.editPaymentDetails' | cxTranslate\"\n        [routerLink]=\"{ cxRoute: paymentDetailsStepRoute } | cxUrl\"\n      >\n        <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n      </a>\n    </div>\n  </div>\n\n  <div class=\"cx-review-summary-card cx-review-summary-payment-card\">\n    <div>\n      <cx-card\n        [content]=\"getPaymentMethodCard(paymentDetails) | async\"\n      ></cx-card>\n    </div>\n    <div class=\"cx-review-summary-edit-step\">\n      <a\n        [attr.aria-label]=\"'checkoutReview.editPaymentDetails' | cxTranslate\"\n        [routerLink]=\"{ cxRoute: paymentDetailsStepRoute } | cxUrl\"\n      >\n        <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n      </a>\n    </div>\n  </div>\n</div>\n", dependencies: [{ kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i5.CardComponent, selector: "cx-card", inputs: ["border", "editMode", "isDefault", "content", "fitToContainer", "truncateText", "charactersLimit", "index"], outputs: ["deleteCard", "setDefaultCard", "sendCard", "editCard", "cancelCard"] }, { kind: "directive", type: i6.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "component", type: i5.IconComponent, selector: "cx-icon,[cxIcon]", inputs: ["cxIcon", "type"] }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }, { kind: "pipe", type: i3.TranslatePipe, name: "cxTranslate" }, { kind: "pipe", type: i3.UrlPipe, name: "cxUrl" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: CheckoutReviewPaymentComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cx-checkout-review-payment', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div\n  class=\"cx-review-summary\"\n  *ngIf=\"paymentDetails$ | async as paymentDetails\"\n>\n  <div class=\"cx-review-summary-card cx-review-summary-payment-card\">\n    <div>\n      <cx-card\n        [content]=\"getBillingAddressCard(paymentDetails) | async\"\n      ></cx-card>\n    </div>\n    <div class=\"cx-review-summary-edit-step\">\n      <a\n        [attr.aria-label]=\"'checkoutReview.editPaymentDetails' | cxTranslate\"\n        [routerLink]=\"{ cxRoute: paymentDetailsStepRoute } | cxUrl\"\n      >\n        <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n      </a>\n    </div>\n  </div>\n\n  <div class=\"cx-review-summary-card cx-review-summary-payment-card\">\n    <div>\n      <cx-card\n        [content]=\"getPaymentMethodCard(paymentDetails) | async\"\n      ></cx-card>\n    </div>\n    <div class=\"cx-review-summary-edit-step\">\n      <a\n        [attr.aria-label]=\"'checkoutReview.editPaymentDetails' | cxTranslate\"\n        [routerLink]=\"{ cxRoute: paymentDetailsStepRoute } | cxUrl\"\n      >\n        <cx-icon aria-hidden=\"true\" [type]=\"iconTypes.PENCIL\"></cx-icon>\n      </a>\n    </div>\n  </div>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i1.CheckoutStepService }, { type: i2.CheckoutPaymentFacade }, { type: i3.TranslationService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tvdXQtcmV2aWV3LXBheW1lbnQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL2NoZWNrb3V0L2Jhc2UvY29tcG9uZW50cy9jaGVja291dC1yZXZpZXcvY2hlY2tvdXQtcmV2aWV3LXBheW1lbnQvY2hlY2tvdXQtcmV2aWV3LXBheW1lbnQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS1saWJzL2NoZWNrb3V0L2Jhc2UvY29tcG9uZW50cy9jaGVja291dC1yZXZpZXcvY2hlY2tvdXQtcmV2aWV3LXBheW1lbnQvY2hlY2tvdXQtcmV2aWV3LXBheW1lbnQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFPbkUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDOUUsT0FBTyxFQUFRLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3hELE9BQU8sRUFBRSxhQUFhLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDakQsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7QUFRN0MsTUFBTSxPQUFPLDhCQUE4QjtJQU96QyxZQUNZLG1CQUF3QyxFQUN4QyxxQkFBNEMsRUFDNUMsa0JBQXNDO1FBRnRDLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsMEJBQXFCLEdBQXJCLHFCQUFxQixDQUF1QjtRQUM1Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBVGxELGNBQVMsR0FBRyxTQUFTLENBQUM7UUFFdEIsNEJBQXVCLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLG9CQUFvQix5REFFdEUsQ0FBQztRQVFGLG9CQUFlLEdBQ2IsSUFBSSxDQUFDLHFCQUFxQixDQUFDLHNCQUFzQixFQUFFLENBQUMsSUFBSSxDQUN0RCxNQUFNLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFDakQsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQzNCLENBQUM7SUFORCxDQUFDO0lBUUosb0JBQW9CLENBQUMsY0FBOEI7UUFDakQsT0FBTyxhQUFhLENBQUM7WUFDbkIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxxQkFBcUIsQ0FBQztZQUN4RCxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLHFCQUFxQixFQUFFO2dCQUN2RCxLQUFLLEVBQUUsY0FBYyxDQUFDLFdBQVc7Z0JBQ2pDLElBQUksRUFBRSxjQUFjLENBQUMsVUFBVTthQUNoQyxDQUFDO1NBQ0gsQ0FBQyxDQUFDLElBQUksQ0FDTCxHQUFHLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxXQUFXLENBQUMsRUFBRSxFQUFFLENBQy9CLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxXQUFXLEVBQUUsY0FBYyxDQUFDLENBQzFELENBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRCxxQkFBcUIsQ0FBQyxjQUE4QjtRQUNsRCxPQUFPLGFBQWEsQ0FBQztZQUNuQixJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLDRCQUE0QixDQUFDO1lBQy9ELElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUM7U0FDeEQsQ0FBQyxDQUFDLElBQUksQ0FDTCxHQUFHLENBQUMsQ0FBQyxDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLENBQy9CLGtCQUFrQixDQUFDLGNBQWMsRUFBRSxNQUFNLEVBQUUsY0FBYyxDQUFDLENBQzNELENBQ0YsQ0FBQztJQUNKLENBQUM7OzJIQTFDVSw4QkFBOEI7K0dBQTlCLDhCQUE4QixrRUN4QjNDLGtwQ0FvQ0E7MkZEWmEsOEJBQThCO2tCQUwxQyxTQUFTOytCQUNFLDRCQUE0QixtQkFFckIsdUJBQXVCLENBQUMsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTUERYLUZpbGVDb3B5cmlnaHRUZXh0OiAyMDIzIFNBUCBTcGFydGFjdXMgdGVhbSA8c3BhcnRhY3VzLXRlYW1Ac2FwLmNvbT5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFBheW1lbnREZXRhaWxzIH0gZnJvbSAnQHNwYXJ0YWN1cy9jYXJ0L2Jhc2Uvcm9vdCc7XG5pbXBvcnQge1xuICBDaGVja291dFBheW1lbnRGYWNhZGUsXG4gIENoZWNrb3V0U3RlcFR5cGUsXG59IGZyb20gJ0BzcGFydGFjdXMvY2hlY2tvdXQvYmFzZS9yb290JztcbmltcG9ydCB7IFRyYW5zbGF0aW9uU2VydmljZSB9IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQgeyBiaWxsaW5nQWRkcmVzc0NhcmQsIHBheW1lbnRNZXRob2RDYXJkIH0gZnJvbSAnQHNwYXJ0YWN1cy9vcmRlci9yb290JztcbmltcG9ydCB7IENhcmQsIElDT05fVFlQRSB9IGZyb20gJ0BzcGFydGFjdXMvc3RvcmVmcm9udCc7XG5pbXBvcnQgeyBjb21iaW5lTGF0ZXN0LCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IENoZWNrb3V0U3RlcFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jaGVja291dC1zdGVwLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjeC1jaGVja291dC1yZXZpZXctcGF5bWVudCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9jaGVja291dC1yZXZpZXctcGF5bWVudC5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBDaGVja291dFJldmlld1BheW1lbnRDb21wb25lbnQge1xuICBpY29uVHlwZXMgPSBJQ09OX1RZUEU7XG5cbiAgcGF5bWVudERldGFpbHNTdGVwUm91dGUgPSB0aGlzLmNoZWNrb3V0U3RlcFNlcnZpY2UuZ2V0Q2hlY2tvdXRTdGVwUm91dGUoXG4gICAgQ2hlY2tvdXRTdGVwVHlwZS5QQVlNRU5UX0RFVEFJTFNcbiAgKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgY2hlY2tvdXRTdGVwU2VydmljZTogQ2hlY2tvdXRTdGVwU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgY2hlY2tvdXRQYXltZW50RmFjYWRlOiBDaGVja291dFBheW1lbnRGYWNhZGUsXG4gICAgcHJvdGVjdGVkIHRyYW5zbGF0aW9uU2VydmljZTogVHJhbnNsYXRpb25TZXJ2aWNlXG4gICkge31cblxuICBwYXltZW50RGV0YWlscyQ6IE9ic2VydmFibGU8UGF5bWVudERldGFpbHMgfCB1bmRlZmluZWQ+ID1cbiAgICB0aGlzLmNoZWNrb3V0UGF5bWVudEZhY2FkZS5nZXRQYXltZW50RGV0YWlsc1N0YXRlKCkucGlwZShcbiAgICAgIGZpbHRlcigoc3RhdGUpID0+ICFzdGF0ZS5sb2FkaW5nICYmICFzdGF0ZS5lcnJvciksXG4gICAgICBtYXAoKHN0YXRlKSA9PiBzdGF0ZS5kYXRhKVxuICAgICk7XG5cbiAgZ2V0UGF5bWVudE1ldGhvZENhcmQocGF5bWVudERldGFpbHM6IFBheW1lbnREZXRhaWxzKTogT2JzZXJ2YWJsZTxDYXJkPiB7XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QoW1xuICAgICAgdGhpcy50cmFuc2xhdGlvblNlcnZpY2UudHJhbnNsYXRlKCdwYXltZW50Rm9ybS5wYXltZW50JyksXG4gICAgICB0aGlzLnRyYW5zbGF0aW9uU2VydmljZS50cmFuc2xhdGUoJ3BheW1lbnRDYXJkLmV4cGlyZXMnLCB7XG4gICAgICAgIG1vbnRoOiBwYXltZW50RGV0YWlscy5leHBpcnlNb250aCxcbiAgICAgICAgeWVhcjogcGF5bWVudERldGFpbHMuZXhwaXJ5WWVhcixcbiAgICAgIH0pLFxuICAgIF0pLnBpcGUoXG4gICAgICBtYXAoKFt0ZXh0VGl0bGUsIHRleHRFeHBpcmVzXSkgPT5cbiAgICAgICAgcGF5bWVudE1ldGhvZENhcmQodGV4dFRpdGxlLCB0ZXh0RXhwaXJlcywgcGF5bWVudERldGFpbHMpXG4gICAgICApXG4gICAgKTtcbiAgfVxuXG4gIGdldEJpbGxpbmdBZGRyZXNzQ2FyZChwYXltZW50RGV0YWlsczogUGF5bWVudERldGFpbHMpOiBPYnNlcnZhYmxlPENhcmQ+IHtcbiAgICByZXR1cm4gY29tYmluZUxhdGVzdChbXG4gICAgICB0aGlzLnRyYW5zbGF0aW9uU2VydmljZS50cmFuc2xhdGUoJ3BheW1lbnRGb3JtLmJpbGxpbmdBZGRyZXNzJyksXG4gICAgICB0aGlzLnRyYW5zbGF0aW9uU2VydmljZS50cmFuc2xhdGUoJ2FkZHJlc3NDYXJkLmJpbGxUbycpLFxuICAgIF0pLnBpcGUoXG4gICAgICBtYXAoKFtiaWxsaW5nQWRkcmVzcywgYmlsbFRvXSkgPT5cbiAgICAgICAgYmlsbGluZ0FkZHJlc3NDYXJkKGJpbGxpbmdBZGRyZXNzLCBiaWxsVG8sIHBheW1lbnREZXRhaWxzKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn1cbiIsIjxkaXZcbiAgY2xhc3M9XCJjeC1yZXZpZXctc3VtbWFyeVwiXG4gICpuZ0lmPVwicGF5bWVudERldGFpbHMkIHwgYXN5bmMgYXMgcGF5bWVudERldGFpbHNcIlxuPlxuICA8ZGl2IGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnktY2FyZCBjeC1yZXZpZXctc3VtbWFyeS1wYXltZW50LWNhcmRcIj5cbiAgICA8ZGl2PlxuICAgICAgPGN4LWNhcmRcbiAgICAgICAgW2NvbnRlbnRdPVwiZ2V0QmlsbGluZ0FkZHJlc3NDYXJkKHBheW1lbnREZXRhaWxzKSB8IGFzeW5jXCJcbiAgICAgID48L2N4LWNhcmQ+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImN4LXJldmlldy1zdW1tYXJ5LWVkaXQtc3RlcFwiPlxuICAgICAgPGFcbiAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCInY2hlY2tvdXRSZXZpZXcuZWRpdFBheW1lbnREZXRhaWxzJyB8IGN4VHJhbnNsYXRlXCJcbiAgICAgICAgW3JvdXRlckxpbmtdPVwieyBjeFJvdXRlOiBwYXltZW50RGV0YWlsc1N0ZXBSb3V0ZSB9IHwgY3hVcmxcIlxuICAgICAgPlxuICAgICAgICA8Y3gtaWNvbiBhcmlhLWhpZGRlbj1cInRydWVcIiBbdHlwZV09XCJpY29uVHlwZXMuUEVOQ0lMXCI+PC9jeC1pY29uPlxuICAgICAgPC9hPlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cblxuICA8ZGl2IGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnktY2FyZCBjeC1yZXZpZXctc3VtbWFyeS1wYXltZW50LWNhcmRcIj5cbiAgICA8ZGl2PlxuICAgICAgPGN4LWNhcmRcbiAgICAgICAgW2NvbnRlbnRdPVwiZ2V0UGF5bWVudE1ldGhvZENhcmQocGF5bWVudERldGFpbHMpIHwgYXN5bmNcIlxuICAgICAgPjwvY3gtY2FyZD5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwiY3gtcmV2aWV3LXN1bW1hcnktZWRpdC1zdGVwXCI+XG4gICAgICA8YVxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIidjaGVja291dFJldmlldy5lZGl0UGF5bWVudERldGFpbHMnIHwgY3hUcmFuc2xhdGVcIlxuICAgICAgICBbcm91dGVyTGlua109XCJ7IGN4Um91dGU6IHBheW1lbnREZXRhaWxzU3RlcFJvdXRlIH0gfCBjeFVybFwiXG4gICAgICA+XG4gICAgICAgIDxjeC1pY29uIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIFt0eXBlXT1cImljb25UeXBlcy5QRU5DSUxcIj48L2N4LWljb24+XG4gICAgICA8L2E+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC9kaXY+XG4iXX0=